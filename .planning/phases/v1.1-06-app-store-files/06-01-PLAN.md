---
phase: v1.1-06-app-store-files
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/src/modules/app-store/shared.tsx
  - livos/packages/ui/src/modules/app-store/app-store-nav.tsx
  - livos/packages/ui/src/modules/app-store/gallery-section.tsx
  - livos/packages/ui/src/modules/app-store/discover/apps-grid-section.tsx
  - livos/packages/ui/src/modules/app-store/discover/apps-row-section.tsx
  - livos/packages/ui/src/modules/app-store/discover/apps-three-column-section.tsx
  - livos/packages/ui/src/routes/app-store/discover.tsx
  - livos/packages/ui/src/routes/app-store/category-page.tsx
  - livos/packages/ui/src/modules/window/app-contents/app-store-routes/shared-components.tsx
  - livos/packages/ui/src/modules/window/app-contents/app-store-routes/discover-window.tsx
  - livos/packages/ui/src/modules/window/app-contents/app-store-routes/category-page-window.tsx
autonomous: true

must_haves:
  truths:
    - "App store shared card/section styles use semantic surface/border/text tokens instead of raw white/XX opacity"
    - "Category navigation chips use semantic tokens"
    - "Gallery/banner carousel uses semantic tokens with simplified gradient overlays (max 1 overlay per item)"
    - "App grid cards use semantic surface/border hierarchy with subtle hover (surface-2, border-default)"
    - "App row horizontal-scroll cards preserve dynamic icon-color gradients but simplify to single layer"
    - "Three-column featured section uses semantic tokens with simplified gradient approach"
    - "Purple/cyan accent colors replaced with brand token for primary actions and focus rings"
    - "Focus rings use focus-visible:border-brand pattern"
    - "Window-mode shared-components.tsx mirrors semantic token changes from sheet mode"
    - "Discover page and category page compositions use semantic tokens"
  artifacts:
    - path: "livos/packages/ui/src/modules/app-store/shared.tsx"
      provides: "Central card/section style definitions with semantic tokens"
      contains: "bg-surface-1"
    - path: "livos/packages/ui/src/modules/app-store/gallery-section.tsx"
      provides: "Banner/gallery carousel with simplified overlays"
      contains: "border-border"
    - path: "livos/packages/ui/src/modules/app-store/discover/apps-grid-section.tsx"
      provides: "Grid app cards with semantic hover"
      contains: "hover:bg-surface-2"
    - path: "livos/packages/ui/src/modules/window/app-contents/app-store-routes/shared-components.tsx"
      provides: "Window-mode duplicates with matching semantic tokens"
      contains: "bg-surface"
  key_links:
    - from: "shared.tsx cardClass/cardFaintClass exports"
      to: "discover sections + window shared-components"
      via: "Tailwind class string imports"
      pattern: "cardClass|cardFaintClass"
    - from: "discover sections"
      to: "semantic tokens"
      via: "bg-surface-*, border-border-*, text-text-* classes"
      pattern: "bg-surface-1|border-border-subtle"
    - from: "window shared-components.tsx"
      to: "sheet-mode shared.tsx"
      via: "parallel style definitions (must stay in sync)"
      pattern: "bg-surface|border-border"
---

<objective>
Migrate the App Store navigation, shared card styles, discover sections (grid/row/three-column), gallery carousel, and window-mode variants to semantic design tokens. Remove excessive gradient layering and glassmorphism effects while preserving dynamic icon-color gradients as a simplified single-layer effect.

Purpose: The App Store discover page is one of the most visually complex pages in LivOS, with 25+ hardcoded purple/cyan accents and dozens of raw white/XX opacity values across shared styles and 5 discover sub-components. Migrating these to the semantic token vocabulary established in Phase 1 ensures visual consistency with the rest of the redesigned application.

Output: All app store navigation, card, and gallery components fully migrated to semantic tokens. Window-mode duplicates updated in parallel.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-06-app-store-files/06-RESEARCH.md

Source files:
@livos/packages/ui/src/modules/app-store/shared.tsx
@livos/packages/ui/src/modules/app-store/app-store-nav.tsx
@livos/packages/ui/src/modules/app-store/gallery-section.tsx
@livos/packages/ui/src/modules/app-store/discover/apps-grid-section.tsx
@livos/packages/ui/src/modules/app-store/discover/apps-row-section.tsx
@livos/packages/ui/src/modules/app-store/discover/apps-three-column-section.tsx
@livos/packages/ui/src/routes/app-store/discover.tsx
@livos/packages/ui/src/routes/app-store/category-page.tsx
@livos/packages/ui/src/modules/window/app-contents/app-store-routes/shared-components.tsx
@livos/packages/ui/src/modules/window/app-contents/app-store-routes/discover-window.tsx
@livos/packages/ui/src/modules/window/app-contents/app-store-routes/category-page-window.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate shared.tsx central styles, gallery-section.tsx, and app-store-nav.tsx (AS-01, AS-02, AS-04)</name>
  <files>
    livos/packages/ui/src/modules/app-store/shared.tsx
    livos/packages/ui/src/modules/app-store/app-store-nav.tsx
    livos/packages/ui/src/modules/app-store/gallery-section.tsx
  </files>
  <action>
These are the foundational files. `shared.tsx` exports cardClass, cardFaintClass, sectionTitleClass, etc. used throughout the app store. Gallery handles banner carousels. Nav handles category chips.

**Opacity mapping reference (apply consistently across ALL files in this plan):**
- `white/[0.03]` or `white/[0.04]` or `white/[0.05]` -> `surface-base` (0.04) or `surface-1` (0.06)
- `white/[0.06]` -> `surface-1` (0.06)
- `white/[0.08]` or `white/5` -> `surface-2` (0.10)
- `white/[0.10]` or `white/10` -> `surface-2` (0.10)
- `white/[0.14]` or `white/[0.15]` -> `surface-3` (0.14)
- `white/20` -> `surface-3` (0.14) or `border-border-emphasis` (0.20) depending on context
- `border-white/[0.06]` or `border-white/5` -> `border-border-subtle`
- `border-white/[0.08]` or `border-white/[0.10]` or `border-white/10` -> `border-border-default`
- `border-white/[0.15]` or `border-white/20` -> `border-border-emphasis`
- `hover:from-white/[0.1]`, `hover:to-white/[0.02]` -> `hover:bg-surface-2`
- `hover:border-white/[0.15]` -> `hover:border-border-default`
- `text-white/40` -> `text-text-tertiary`
- `text-white/50` -> `text-text-tertiary`
- `text-white/55` -> `text-text-secondary`
- `text-white/60` -> `text-text-secondary`
- `text-white/70` -> `text-text-primary`
- `text-white/80` -> `text-text-primary`
- `opacity-50` (on text) -> replace with `text-text-tertiary` or `text-text-secondary`
- `opacity-40` (on text) -> replace with `text-text-tertiary`
- `purple-500` (accent) -> `brand`
- `cyan-500` (accent) -> `brand` (or remove if purely decorative gradient)
- `purple-400/80`, `purple-300/80` -> `brand`/`brand-lighter`
- `focus:ring-purple-500/50` -> `focus-visible:border-brand focus-visible:ring-2 focus-visible:ring-brand/20`
- `shadow-[0_8px_32px_rgba(0,0,0,0.4)]` -> `shadow-elevation-md`
- `shadow-[0_20px_60px...]` -> `shadow-elevation-lg`
- `backdrop-blur-xl` -> remove (Minimal & Clean = flat surfaces)

**shared.tsx (~276 lines):**

1. `cardBaseClass`: Keep structural classes (rounded, overflow-hidden, cursor-pointer, transition). If it has raw values, migrate them.

2. `cardClass`: This is the main card style. Replace the gradient-to-br + multi-opacity layers + backdrop-blur with a flat surface approach:
   - Remove `bg-gradient-to-br from-white/[0.08] via-white/[0.04] to-transparent` -> `bg-surface-1`
   - Remove `backdrop-blur-xl`
   - `border border-white/[0.08]` -> `border border-border-subtle`
   - `shadow-[0_8px_32px_rgba(0,0,0,0.4)]` -> `shadow-elevation-sm`
   - Hover: Remove gradient hover, use `hover:bg-surface-2 hover:border-border-default hover:shadow-elevation-md`
   - Focus: `focus:ring-purple-500/50` -> `focus-visible:border-brand focus-visible:ring-2 focus-visible:ring-brand/20`

3. `cardFaintClass`: Similar migration — replace raw opacities with surface-base, border-subtle.

4. `sectionTitleClass`, `sectionSubtitleClass`, other text classes:
   - `text-white/70` or similar -> `text-text-primary`
   - `text-white/50` or similar -> `text-text-secondary`
   - `text-white/40` -> `text-text-tertiary`

5. Any `purple-500`, `cyan-500`, `indigo-500` in accent contexts -> `brand`

6. Remove any glow orb divs (absolute positioned blur circles with purple/cyan).

**app-store-nav.tsx (~89 lines):**
- Migrate any `gap-[5px]` if it appears — this is a minor raw value, can keep if it's functional spacing.
- Ensure any category chip styling uses semantic tokens if it has raw white/XX values.
- Uses ButtonLink — likely minimal changes needed. Just migrate any raw opacity text/border values.

**gallery-section.tsx (~193 lines):**
- This has heavy gradient overlays on banner items. Simplify:
  - Remove multi-layer gradient overlays (keep at most 1 subtle dark overlay for text readability on images)
  - `white/5`, `white/10`, `white/20` backgrounds -> `surface-base`, `surface-2`, `surface-3`
  - `black/60`, `black/40` overlays for text readability -> simplify to single `bg-gradient-to-t from-black/60` (one layer)
  - `purple-500`, `cyan-500` decorative accents -> remove or replace with brand
  - `shadow-[0_20px_60px...]` -> `shadow-elevation-lg`
  - Any border raw values -> `border-border-subtle` or `border-border-default`

**Do NOT modify:**
- Logic, hooks, event handlers, or state management
- App data structures or type definitions
- The `useColorThief` hook calls (preserve dynamic color extraction)
- Import paths (unless adding cn import)
  </action>
  <verify>
Run `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` — no type errors.
Search for `backdrop-blur-xl` in shared.tsx — should not exist (removed for flat surfaces).
Search for `purple-500` in shared.tsx — should not exist (replaced with brand).
Search for `white/\[0\.` in shared.tsx — should not exist (all fractional opacities replaced).
Search for `bg-surface` in shared.tsx — should exist (confirms semantic migration).
  </verify>
  <done>
shared.tsx cardClass/cardFaintClass/sectionTitleClass use semantic tokens (surface-1, border-subtle, elevation-sm). Gallery has simplified overlays (max 1 gradient layer for text readability). Purple/cyan accents replaced with brand. Nav chips migrated. No business logic modified.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate discover sections (grid, row, three-column) and route compositions (AS-02, AS-04)</name>
  <files>
    livos/packages/ui/src/modules/app-store/discover/apps-grid-section.tsx
    livos/packages/ui/src/modules/app-store/discover/apps-row-section.tsx
    livos/packages/ui/src/modules/app-store/discover/apps-three-column-section.tsx
    livos/packages/ui/src/routes/app-store/discover.tsx
    livos/packages/ui/src/routes/app-store/category-page.tsx
  </files>
  <action>
Use the same opacity mapping reference from Task 1.

**apps-grid-section.tsx (~165 lines):**
1. Card containers:
   - `white/[0.02]`, `white/[0.06]`, `white/[0.1]` backgrounds -> `surface-base`, `surface-1`, `surface-2`
   - `purple-500/40` glow effects -> remove entirely
   - `shadow-[0_8px_30px...]` -> `shadow-elevation-sm`
   - `white/10` borders -> `border-border-default`
   - Hover: `purple-500/0` -> `cyan-500/0` gradient tricks -> replace with `hover:bg-surface-2 hover:border-border-default`
2. Text:
   - `text-[15px]` -> `text-body` (14px) or keep as `text-body-lg` (16px) — choose closest
   - `text-[13px]` -> `text-body-sm` (13px)
   - `white/40` -> `text-text-tertiary`
   - `white/55` -> `text-text-secondary`
3. Remove any glow/orb divs with `blur-3xl` and purple/cyan backgrounds.

**apps-row-section.tsx (~147 lines):**
1. This uses `useColorThief` for dynamic icon-color gradients. **Preserve the color extraction and dynamic gradient, but simplify:**
   - Keep the single dynamic gradient background derived from icon colors
   - Remove additional overlay layers (if there are 2-3 stacked gradients, reduce to 1)
   - `white/[0.1]`, `white/[0.2]` -> `surface-2`, `surface-3`
   - `ring-2 ring-white/20` -> `ring-2 ring-border-emphasis`
   - `shadow-[0_8px_32px...]`, `shadow-[0_20px_50px...]` -> `shadow-elevation-md`
   - `white/60` -> `text-text-secondary`
   - `white/40` -> `text-text-tertiary`
   - `white/[0.08]` -> `surface-2`
2. The dynamic style={{ background: `linear-gradient(...)` }} using extracted colors — PRESERVE this entirely.

**apps-three-column-section.tsx (~240 lines):**
1. This is the most complex section with featured cards and decorative gradients.
   - `white/[0.08]`, `white/[0.06]` backgrounds -> `surface-2`, `surface-1`
   - `purple-500/10`, `cyan-500/10` decorative gradients -> remove
   - `indigo-500/20`, `pink-500/5` -> remove (decorative only)
   - `white/5` -> `surface-base`
   - `white/50` -> `text-text-secondary`
   - `ring-2 ring-white/20` -> `ring-2 ring-border-emphasis`
   - `shadow-[0_12px_40px...]` -> `shadow-elevation-md`
   - `black/30` overlays -> simplify to single overlay if needed for text readability
   - `white/10` borders -> `border-border-default`
2. **Preserve dynamic icon-color gradients from useColorThief** — just simplify the layering.

**routes/app-store/discover.tsx (~116 lines):**
- `text-15` -> `text-body` or `text-body-lg` (check which pixel size text-15 maps to)
- `text-12` -> `text-caption`
- `white/80` -> `text-text-primary`
- `white/50` -> `text-text-secondary`

**routes/app-store/category-page.tsx (~50 lines):**
- Minimal changes — migrate any raw opacity values found.

**Do NOT modify:**
- `useColorThief` hook calls or dynamic color extraction logic
- Section component props or data flow
- Animation/transition logic
- Import paths (unless adding cn)
  </action>
  <verify>
Run `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` — no type errors.
Search for `purple-500` in apps-grid-section.tsx — should not exist.
Search for `cyan-500` in apps-three-column-section.tsx — should not exist (unless in dynamic gradient logic).
Search for `white/\[0\.` across all 5 files — should be 0 matches.
Verify `useColorThief` references are preserved in apps-row-section.tsx and apps-three-column-section.tsx.
  </verify>
  <done>
All 3 discover sections (grid, row, three-column) use semantic surface/border/text tokens. Dynamic icon-color gradients preserved in row and three-column sections with simplified layering. Decorative purple/cyan gradients removed. Route compositions (discover, category-page) migrated. No logic modified.
  </done>
</task>

<task type="auto">
  <name>Task 3: Migrate window-mode app store variants (AS-01, AS-02)</name>
  <files>
    livos/packages/ui/src/modules/window/app-contents/app-store-routes/shared-components.tsx
    livos/packages/ui/src/modules/window/app-contents/app-store-routes/discover-window.tsx
    livos/packages/ui/src/modules/window/app-contents/app-store-routes/category-page-window.tsx
  </files>
  <action>
Use the same opacity mapping reference from Task 1.

The window-mode variants duplicate styling from the sheet-mode components. They must be updated to match the semantic token vocabulary applied in Tasks 1-2.

**shared-components.tsx (~214 lines):**
This file contains duplicated card/section components for window rendering. Apply the same semantic token migration:
1. Card containers:
   - `white/4` -> `surface-base`
   - `white/10` -> `surface-2`
   - `white/22` -> `surface-3` or `border-border-emphasis`
   - `rounded-20` -> `rounded-radius-xl` (20px)
   - `rounded-10` -> `rounded-radius-md` (12px, close enough)
   - `rounded-24` -> `rounded-radius-xl` (closest semantic)
2. Text:
   - `text-13` -> `text-body-sm`
   - `text-15` -> `text-body` or `text-body-lg`
   - `text-12` -> `text-caption`
3. Hex colors:
   - `#24242499` -> use `bg-surface-2` (this is a dark semi-transparent background)
   - `#18181899` -> use `bg-surface-1` (darker semi-transparent)
4. Border values:
   - Any raw white/XX borders -> `border-border-subtle` or `border-border-default`

**discover-window.tsx (~114 lines):**
- Imports from shared-components — mostly composition. Migrate any local raw values.

**category-page-window.tsx (~53 lines):**
- Minimal — migrate any raw opacity values found.

**Critical: Ensure window-mode and sheet-mode produce visually consistent results using the same semantic token vocabulary.**

**Do NOT modify:**
- Component props or data flow
- Window-specific layout sizing (windows need different dimensions than sheets)
- Routing logic
  </action>
  <verify>
Run `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` — no type errors.
Search for `#242424` in shared-components.tsx — should not exist (replaced with semantic token).
Search for `#181818` in shared-components.tsx — should not exist.
Search for `white/4` (without bracket) in shared-components.tsx — should not exist.
Verify `bg-surface` appears in shared-components.tsx — confirms migration.
  </verify>
  <done>
Window-mode shared-components.tsx, discover-window.tsx, and category-page-window.tsx all use semantic tokens matching sheet-mode counterparts. Hex color values replaced with semantic equivalents. Rounded values use semantic radii. Both rendering paths now use consistent token vocabulary.
  </done>
</task>

</tasks>

<verification>
After all three tasks complete:

1. `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` passes
2. `grep -r 'purple-500' livos/packages/ui/src/modules/app-store/shared.tsx livos/packages/ui/src/modules/app-store/gallery-section.tsx livos/packages/ui/src/modules/app-store/discover/` — should return 0 matches
3. `grep -r 'cyan-500' livos/packages/ui/src/modules/app-store/discover/` — should return 0 matches (unless inside dynamic style prop)
4. `grep -r 'backdrop-blur-xl' livos/packages/ui/src/modules/app-store/shared.tsx` — should return 0
5. `grep -r 'bg-surface' livos/packages/ui/src/modules/app-store/shared.tsx` — should return 1+ matches
6. `grep -r '#242424' livos/packages/ui/src/modules/window/app-contents/app-store-routes/shared-components.tsx` — should return 0
7. `useColorThief` references preserved in apps-row-section.tsx and apps-three-column-section.tsx
8. No business logic, hooks, state, or data structures modified
9. Both sheet-mode and window-mode variants use consistent semantic token vocabulary
</verification>

<success_criteria>
- shared.tsx cardClass uses bg-surface-1, border-border-subtle, shadow-elevation-sm (no gradient-to-br, no backdrop-blur)
- Hover effects are subtle: hover:bg-surface-2 hover:border-border-default hover:shadow-elevation-md
- Focus rings use focus-visible:border-brand pattern
- All purple-500/cyan-500 accent colors replaced with brand token
- Gallery carousel has max 1 gradient overlay per banner (simplified from 3-4 layers)
- Dynamic icon-color gradients (useColorThief) preserved in row/three-column sections
- Grid section cards use semantic surface/border hierarchy
- All text-white/XX opacity values replaced with text-text-primary/secondary/tertiary
- All bg-white/[X.XX] replaced with bg-surface-base/1/2/3
- Window-mode shared-components.tsx matches semantic token vocabulary of sheet-mode
- No type errors introduced
- No business logic modified
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-06-app-store-files/06-01-SUMMARY.md`
</output>
