---
phase: v2.0-04-dashboard-home
plan: 02
type: execute
wave: 2
depends_on: [01]
files_modified:
  - livos/packages/ui/src/modules/desktop/desktop-content.tsx
autonomous: true

must_haves:
  truths:
    - "Desktop home screen shows WidgetGrid instead of icon grid on desktop"
    - "Icon grid may still show on mobile as a compact app launcher"
---

<objective>
Replace the current icon grid desktop content with the new WidgetGrid dashboard.

The DesktopContent currently shows: Header (greeting) + AppGrid (paginated icon grid) + Search button + DockSpacer.
It should now show: WidgetGrid (which includes its own header/greeting).
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Replace desktop content with WidgetGrid</name>
  <files>livos/packages/ui/src/modules/desktop/desktop-content.tsx</files>
  <action>
Read the current file. Replace the desktop content to use WidgetGrid:

```tsx
import {motion, Variant} from 'framer-motion'
import {useLocation} from 'react-router-dom'

import {useIsMobile} from '@/hooks/use-is-mobile'
import {useApps} from '@/providers/apps'
import {trpcReact} from '@/trpc/trpc'
import {WidgetGrid} from '@/modules/dashboard'

import {AppGrid} from './app-grid/app-grid'
import {AppIconConnected} from './app-icon'
import {Search} from './desktop-misc'
import {DockSpacer} from './dock'
import {Header} from './header'

export function DesktopContent({onSearchClick}: {onSearchClick?: () => void}) {
    const {pathname} = useLocation()
    const isMobile = useIsMobile()

    const getQuery = trpcReact.user.get.useQuery()
    const name = getQuery.data?.name

    const {userApps, isLoading} = useApps()

    if (isLoading) return null
    if (!userApps) return null
    if (!name) return null

    type DesktopVariant = 'default' | 'overlayed'
    const variant: DesktopVariant = pathname === '/' ? 'default' : 'overlayed'

    const variants: Record<DesktopVariant, Variant> = {
        default: {
            opacity: 1,
        },
        overlayed: {
            translateY: 0,
            opacity: 0,
            transition: {
                duration: 0,
            },
        },
    }

    // Desktop: show widget dashboard
    // Mobile: show classic app grid
    return (
        <motion.div
            className='flex h-full w-full select-none flex-col overflow-y-auto'
            variants={variants}
            animate={variant}
            initial={{opacity: 1}}
            transition={{duration: 0.15, ease: 'easeOut'}}
        >
            {isMobile ? (
                <>
                    <div className='pt-6' />
                    <Header userName={name} />
                    <div className='pt-6' />
                    <div className='flex w-full grow overflow-hidden'>
                        <AppGrid
                            apps={userApps.map((app, i) => (
                                <motion.div
                                    key={app.id}
                                    layout
                                    initial={{opacity: 0, scale: 0.75}}
                                    animate={{opacity: 1, scale: 1}}
                                    exit={{opacity: 0, scale: 0.75}}
                                    transition={{delay: i * 0.01, duration: 0.2, ease: 'easeOut'}}
                                >
                                    <AppIconConnected appId={app.id} />
                                </motion.div>
                            ))}
                        />
                    </div>
                    <Search onClick={onSearchClick} />
                    <div className='pt-6' />
                    <DockSpacer />
                </>
            ) : (
                <WidgetGrid />
            )}
        </motion.div>
    )
}
```

The key change: on desktop (not mobile), render WidgetGrid instead of the old Header+AppGrid+Search+DockSpacer. On mobile, keep the existing app grid layout.
  </action>
</task>

</tasks>

<verification>
1. Desktop home screen shows widget grid with system health, apps, quick actions
2. Mobile still shows the classic app grid
3. Run `cd livos && pnpm build`
</verification>
