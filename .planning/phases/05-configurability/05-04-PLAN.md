---
phase: 05-configurability
plan: 04
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - livos/skills/research.ts
  - livos/skills/leadgen-auto.ts
  - livos/skills/site-audit.ts
  - livos/skills/content.ts
  - livos/packages/livinityd/skills/content.ts
  - livos/packages/livinityd/skills/leadgen-auto.ts
  - livos/packages/livinityd/skills/research.ts
  - livos/packages/livinityd/skills/site-audit.ts
autonomous: true

must_haves:
  truths:
    - "Skills save output files to configurable directory"
    - "Output path is constructed using paths.output from @livos/config"
    - "Prompts dynamically include the configured output path"
    - "AI agents can save files to custom output locations"
  artifacts:
    - path: "livos/skills/research.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/skills/leadgen-auto.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/skills/site-audit.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/skills/content.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/packages/livinityd/skills/content.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/packages/livinityd/skills/leadgen-auto.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/packages/livinityd/skills/research.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
    - path: "livos/packages/livinityd/skills/site-audit.ts"
      provides: "config-driven output path in prompts"
      pattern: "paths\\.output|LIVOS_OUTPUT_DIR"
  key_links:
    - from: "livos/skills/*.ts"
      to: "@livos/config"
      via: "import { paths }"
      pattern: "from ['\"]@livos/config['\"]"
    - from: "livos/packages/livinityd/skills/*.ts"
      to: "@livos/config"
      via: "import { paths }"
      pattern: "from ['\"]@livos/config['\"]"
---

<objective>
Replace hardcoded /opt/livos/output/ paths in skill files with config-driven paths using @livos/config.

Purpose: Skills contain prompts that instruct AI agents where to save generated files. Hardcoded paths break custom installations. Using paths.output from @livos/config (added in Plan 05-01) allows skills to work with any installation directory.

Output: All skill files dynamically construct output paths from configuration instead of hardcoded /opt/livos/output/ strings.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-configurability/05-RESEARCH.md

# Depends on Plan 05-01 which adds paths.output to @livos/config
# Reference config package
@livos/packages/config/src/paths.ts
@livos/packages/config/src/index.ts

# Files to modify - root skills
@livos/skills/research.ts
@livos/skills/leadgen-auto.ts
@livos/skills/site-audit.ts
@livos/skills/content.ts

# Files to modify - livinityd skills
@livos/packages/livinityd/skills/content.ts
@livos/packages/livinityd/skills/leadgen-auto.ts
@livos/packages/livinityd/skills/research.ts
@livos/packages/livinityd/skills/site-audit.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace hardcoded output paths in root skills</name>
  <files>
    livos/skills/research.ts
    livos/skills/leadgen-auto.ts
    livos/skills/site-audit.ts
    livos/skills/content.ts
  </files>
  <action>
    For each skill file (research.ts, leadgen-auto.ts, site-audit.ts, content.ts):

    1. Add imports at top of file:
       ```typescript
       import { paths } from '@livos/config';
       import path from 'node:path';
       ```

    2. Find the hardcoded output path in the prompt/instruction string.
       Pattern to find: `/opt/livos/output/` (around lines 83, 88, 82, 101 respectively)

    3. Replace with dynamic path construction:
       ```typescript
       // BEFORE (in template literal prompt):
       `Save the report to a file at /opt/livos/output/research-${Date.now()}.md`

       // AFTER:
       // Outside the template literal, construct the path:
       const outputPath = path.join(paths.output, `research-${Date.now()}.md`);
       // Then in the prompt:
       `Save the report to a file at ${outputPath}`
       ```

    4. If the filename pattern varies (research-, leadgen-, audit-, content-), preserve it:
       - research.ts: `research-${timestamp}.md`
       - leadgen-auto.ts: `leadgen-${timestamp}.md` or similar
       - site-audit.ts: `audit-${timestamp}.md` or similar
       - content.ts: `content-${timestamp}.md` or similar

    Note: Skills are TypeScript files that export prompt strings or functions. The prompt strings contain instructions for AI agents that include file paths.
  </action>
  <verify>
    1. Grep for remaining hardcoded paths:
       ```bash
       grep -n "/opt/livos/output" livos/skills/research.ts livos/skills/leadgen-auto.ts livos/skills/site-audit.ts livos/skills/content.ts
       ```
       Should return empty (no matches).

    2. Verify config import exists:
       ```bash
       grep -l "@livos/config" livos/skills/research.ts livos/skills/leadgen-auto.ts livos/skills/site-audit.ts livos/skills/content.ts
       ```
       Should list all 4 files.

    3. TypeScript check:
       ```bash
       cd livos && pnpm tsc --noEmit
       ```
  </verify>
  <done>
    - research.ts uses paths.output for output directory
    - leadgen-auto.ts uses paths.output for output directory
    - site-audit.ts uses paths.output for output directory
    - content.ts uses paths.output for output directory
    - All use path.join() for path construction
    - No hardcoded /opt/livos/output in any root skill file
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace hardcoded output paths in livinityd skills</name>
  <files>
    livos/packages/livinityd/skills/content.ts
    livos/packages/livinityd/skills/leadgen-auto.ts
    livos/packages/livinityd/skills/research.ts
    livos/packages/livinityd/skills/site-audit.ts
  </files>
  <action>
    For each livinityd skill file (content.ts, leadgen-auto.ts, research.ts, site-audit.ts):

    1. Add imports at top of file:
       ```typescript
       import { paths } from '@livos/config';
       import path from 'node:path';
       ```

    2. Find the hardcoded output path in the prompt/instruction string.
       Pattern to find: `/opt/livos/output/` (around lines 101, 88, 83, 82 respectively)

    3. Replace with dynamic path construction (same pattern as Task 1):
       ```typescript
       const outputPath = path.join(paths.output, `content-${Date.now()}.md`);
       // Use outputPath in the prompt string
       ```

    4. Preserve the existing filename patterns for each skill type.

    Note: These files may be duplicates of the root skills or may have slight variations. Apply the same transformation pattern regardless.
  </action>
  <verify>
    1. Grep for remaining hardcoded paths:
       ```bash
       grep -n "/opt/livos/output" livos/packages/livinityd/skills/content.ts livos/packages/livinityd/skills/leadgen-auto.ts livos/packages/livinityd/skills/research.ts livos/packages/livinityd/skills/site-audit.ts
       ```
       Should return empty (no matches).

    2. Verify config import exists:
       ```bash
       grep -l "@livos/config" livos/packages/livinityd/skills/content.ts livos/packages/livinityd/skills/leadgen-auto.ts livos/packages/livinityd/skills/research.ts livos/packages/livinityd/skills/site-audit.ts
       ```
       Should list all 4 files.

    3. TypeScript check:
       ```bash
       cd livos/packages/livinityd && pnpm build
       ```
  </verify>
  <done>
    - livinityd/skills/content.ts uses paths.output for output directory
    - livinityd/skills/leadgen-auto.ts uses paths.output for output directory
    - livinityd/skills/research.ts uses paths.output for output directory
    - livinityd/skills/site-audit.ts uses paths.output for output directory
    - All use path.join() for path construction
    - No hardcoded /opt/livos/output in livinityd skill files
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. No hardcoded output paths remain in any skill file:
   ```bash
   grep -rn "/opt/livos/output" livos/skills/ livos/packages/livinityd/skills/
   ```
   Should return empty.

2. All skill files import from @livos/config:
   ```bash
   grep -l "@livos/config" livos/skills/*.ts livos/packages/livinityd/skills/*.ts
   ```
   Should list all 8 files.

3. paths.output is used in each file:
   ```bash
   grep -l "paths.output" livos/skills/*.ts livos/packages/livinityd/skills/*.ts
   ```
   Should list all 8 files.

4. TypeScript builds succeed:
   ```bash
   cd livos && pnpm build
   ```
</verification>

<success_criteria>
- All 8 skill files import from @livos/config
- All 8 skill files use paths.output for output directory
- All 8 skill files use path.join() for path construction
- Zero hardcoded "/opt/livos/output" strings in skill files
- Prompts dynamically include the configured output path
- TypeScript compilation passes for all affected packages
</success_criteria>

<output>
After completion, create `.planning/phases/05-configurability/05-04-SUMMARY.md`
</output>
