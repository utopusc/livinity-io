---
phase: v1.1-02-desktop-shell
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/src/modules/desktop/dock.tsx
  - livos/packages/ui/src/modules/desktop/dock-item.tsx
  - livos/packages/ui/src/modules/desktop/blur-below-dock.tsx
  - livos/packages/ui/src/components/ui/notification-badge.tsx
autonomous: true

must_haves:
  truths:
    - "Dock has a visually slimmer profile through reduced padding while keeping 50px icon size"
    - "Dock container uses semantic surface/border/radius tokens instead of raw opacity values"
    - "Dock items use semantic surface/border tokens for icon container backgrounds and borders"
    - "Dock divider uses semantic border token instead of raw border-white/10"
    - "Dock icon text color uses semantic text-primary token"
    - "Notification badge uses semantic caption-sm typography instead of raw text-[11px]"
    - "Dock magnification spring physics still work smoothly with reduced padding"
  artifacts:
    - path: "livos/packages/ui/src/modules/desktop/dock.tsx"
      provides: "Redesigned dock with semantic tokens and slimmer padding"
      contains: "bg-surface-base"
    - path: "livos/packages/ui/src/modules/desktop/dock-item.tsx"
      provides: "Dock items with semantic surface/border tokens"
      contains: "bg-surface-2"
    - path: "livos/packages/ui/src/modules/desktop/blur-below-dock.tsx"
      provides: "Blur below dock (minimal changes)"
      contains: "pointer-events-none"
    - path: "livos/packages/ui/src/components/ui/notification-badge.tsx"
      provides: "Notification badge with semantic typography"
      contains: "text-caption-sm"
  key_links:
    - from: "livos/packages/ui/src/modules/desktop/dock.tsx"
      to: "livos/packages/ui/tailwind.config.ts"
      via: "Semantic token classes for surface, border, radius"
      pattern: "(bg-surface-|border-border-|rounded-radius-)"
    - from: "livos/packages/ui/src/modules/desktop/dock-item.tsx"
      to: "livos/packages/ui/tailwind.config.ts"
      via: "Semantic token classes for surface, border, text"
      pattern: "(bg-surface-|border-border-|text-text-)"
    - from: "livos/packages/ui/src/modules/desktop/dock.tsx"
      to: "livos/packages/ui/src/modules/floating-island/container.tsx"
      via: "Dock height determines island bottom positioning"
      pattern: "bottom-\\["
---

<objective>
Redesign the dock with a slimmer profile and semantic design tokens. Migrate all raw Tailwind opacity values to Phase 1 semantic tokens while preserving the Framer Motion magnification physics and existing interaction behavior.

Purpose: The dock is the most prominent desktop shell element. DD-01 requires a slimmer profile, refined hover animations, and a cleaner divider. This plan focuses on token migration and padding reduction without changing icon sizes (kept at 50px) or spring physics parameters to minimize risk.

Output: Updated dock.tsx, dock-item.tsx, blur-below-dock.tsx, and notification-badge.tsx with semantic tokens and reduced padding for a slimmer dock appearance.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-02-desktop-shell/02-RESEARCH.md
@.planning/phases/v1.1-01-design-system/01-01-SUMMARY.md

@livos/packages/ui/tailwind.config.ts
@livos/packages/ui/src/modules/desktop/dock.tsx
@livos/packages/ui/src/modules/desktop/dock-item.tsx
@livos/packages/ui/src/modules/desktop/blur-below-dock.tsx
@livos/packages/ui/src/components/ui/notification-badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate dock container and divider to semantic tokens with slimmer padding</name>
  <files>livos/packages/ui/src/modules/desktop/dock.tsx, livos/packages/ui/src/modules/desktop/blur-below-dock.tsx</files>
  <action>
Update dock.tsx class strings and padding constants. Preserve all Framer Motion animation code, the magnification system, DockBottomPositioner, DockSpacer, and component structure. Only change class strings and the padding constant.

**Dock padding reduction (slimmer profile):**
- Change the desktop `padding` constant from `12` to `10` in the dimensions object (line ~46 area where iconSize/iconSizeZoomed/padding are defined for desktop). This reduces dock height from 74px (50+12+12) to 70px (50+10+10). Keep mobile padding at `8`. Keep preview padding at `12` (previews are independent).
- Keep `DOCK_BOTTOM_PADDING_PX = 10` unchanged.
- Keep `iconSize = 50` and `iconSizeZoomed = 80` unchanged for desktop. Do NOT change spring physics parameters (mass, stiffness, damping) or the useTransform distance range `[-150, 0, 150]`.

**dockClass (line ~305) — migrate tokens:**
Current:
```
mx-auto flex items-end gap-3 rounded-2xl bg-black/10 contrast-more:bg-neutral-700 backdrop-blur-2xl contrast-more:backdrop-blur-none px-3 shadow-dock shrink-0 will-change-transform transform-gpu border-hpx border-white/10
```

New:
```
mx-auto flex items-end gap-3 rounded-radius-xl bg-surface-base contrast-more:bg-neutral-700 backdrop-blur-2xl contrast-more:backdrop-blur-none px-2.5 shadow-dock shrink-0 will-change-transform transform-gpu border-hpx border-border-default
```

Changes:
- `rounded-2xl` -> `rounded-radius-xl` (20px, consistent with design system)
- `bg-black/10` -> `bg-surface-base` (0.04 opacity, subtler — dock already has backdrop-blur so slightly less bg is fine)
- `border-white/10` -> `border-border-default` (0.10, same value)
- `px-3` -> `px-2.5` (reduce horizontal padding for slimmer feel)
- Keep `shadow-dock` (component-specific shadow preserved per Phase 1 decision)
- Keep `backdrop-blur-2xl` (dock blur is essential for readability)
- Keep all contrast-more:, will-change-transform, transform-gpu

**dockPreviewClass (line ~306) — migrate tokens:**
Current:
```
mx-auto flex items-end gap-4 rounded-2xl bg-neutral-900/80 px-3 shadow-dock shrink-0 border-hpx border-white/10
```

New:
```
mx-auto flex items-end gap-4 rounded-radius-xl bg-neutral-900/80 px-3 shadow-dock shrink-0 border-hpx border-border-default
```

Changes:
- `rounded-2xl` -> `rounded-radius-xl`
- `border-white/10` -> `border-border-default`
- Keep `bg-neutral-900/80` (preview uses solid bg, not surface token)
- Keep `px-3` for preview (preview doesn't need slimmer padding)

**DockDivider (line ~309 area) — cleaner divider:**
Current:
```html
<div className='br grid w-1 place-items-center' style={{height: iconSize}}>
    <div className='h-7 border-r border-white/10' />
</div>
```

New:
```html
<div className='br grid w-1 place-items-center' style={{height: iconSize}}>
    <div className='h-6 border-r border-border-subtle' />
</div>
```

Changes:
- `border-white/10` -> `border-border-subtle` (subtler divider, 0.06 instead of 0.10)
- `h-7` -> `h-6` (shorter divider for cleaner, more minimal feel)

**blur-below-dock.tsx — keep as-is:**
The blur-below-dock component uses inline styles and CSS mask gradients. No semantic token migration needed. Leave this file unchanged unless you see an opportunity to replace a raw class value. The only Tailwind class is:
```
pointer-events-none fixed inset-0 top-0 backdrop-blur-2xl duration-500 animate-in fade-in fill-mode-both
```
This is functional positioning/animation — no raw color/border/text tokens to migrate.
  </action>
  <verify>
Grep for `bg-surface-base` in dock.tsx to confirm semantic surface token on dock container.
Grep for `border-border-default` in dock.tsx to confirm semantic border tokens.
Grep for `rounded-radius-xl` in dock.tsx to confirm semantic radius.
Grep for `border-border-subtle` in dock.tsx to confirm cleaner divider.
Grep for `px-2.5` in dock.tsx to confirm slimmer horizontal padding.
Confirm the desktop padding constant is `10` (not `12`) by grepping for the dimensions object.
Confirm `iconSize` is still `50` for desktop by grepping dock.tsx.
Run `npx tsc --noEmit` in the ui package to verify compilation.
  </verify>
  <done>
Dock container uses semantic tokens (surface-base, border-default, radius-xl). Dock has slimmer profile via reduced padding (12->10) and horizontal padding (px-3->px-2.5). Divider uses border-subtle and is shorter (h-7->h-6). Icon size remains 50px and spring physics unchanged. Preview dock uses matching semantic border tokens.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate dock-item and notification-badge to semantic tokens</name>
  <files>livos/packages/ui/src/modules/desktop/dock-item.tsx, livos/packages/ui/src/components/ui/notification-badge.tsx</files>
  <action>
Update dock-item.tsx class strings. Preserve all Framer Motion animation code (useTransform, useSpring, bounce animation, OpenPill), the click handlers, and component structure. Only change Tailwind class strings.

**Icon glow div (line ~121):**
Current:
```
absolute hidden h-full w-full rounded-xl bg-white/20 opacity-30 md:block
```

New:
```
absolute hidden h-full w-full rounded-radius-lg bg-surface-3 opacity-30 md:block
```

Changes:
- `rounded-xl` -> `rounded-radius-lg` (16px, same value as Tailwind xl)
- `bg-white/20` -> `bg-surface-3` (0.14 opacity — slightly subtler glow, reducing glassmorphism per design direction)
- Keep `opacity-30` (this is a deliberate glow effect multiplier)

**Icon container (line ~129-131):**
Current:
```
relative origin-top-left rounded-xl bg-white/10 backdrop-blur-md border border-white/20 transition-[filter] has-[:focus-visible]:brightness-125 flex items-center justify-center
```

New:
```
relative origin-top-left rounded-radius-lg bg-surface-2 backdrop-blur-md border border-border-emphasis transition-[filter] has-[:focus-visible]:brightness-125 flex items-center justify-center
```

Changes:
- `rounded-xl` -> `rounded-radius-lg` (16px, same)
- `bg-white/10` -> `bg-surface-2` (0.10, same value)
- `border-white/20` -> `border-border-emphasis` (0.20, same value)
- Keep `backdrop-blur-md`, `transition-[filter]`, `has-[:focus-visible]:brightness-125`
- Keep `origin-top-left` (needed for spring magnification)

**React Icon (line ~149):**
Current:
```
h-[55%] w-[55%] text-white/90 drop-shadow-md
```

New:
```
h-[55%] w-[55%] text-text-primary drop-shadow-md
```

Changes:
- `text-white/90` -> `text-text-primary` (0.90, same value)

**OpenPill indicator (line ~183):**
Keep UNCHANGED:
```
absolute -bottom-[7px] left-1/2 h-[2px] w-[10px] -translate-x-1/2 rounded-full bg-white
```
The open pill is intentionally pure white for maximum visibility. Do not migrate to a semantic token.

**notification-badge.tsx — migrate typography:**
Current:
```
absolute -right-1 -top-1 flex h-[17px] min-w-[17px] select-none items-center justify-center rounded-full bg-red-600/80 px-1 text-[11px] font-bold shadow-md shadow-red-800/50 animate-in zoom-in
```

New:
```
absolute -right-1 -top-1 flex h-[17px] min-w-[17px] select-none items-center justify-center rounded-full bg-red-600/80 px-1 text-caption-sm font-bold shadow-md shadow-red-800/50 animate-in zoom-in
```

Changes:
- `text-[11px]` -> `text-caption-sm` (11px with line-height and letter-spacing)
- Keep `bg-red-600/80` (semantic red notification color, not a surface token)
- Keep all positioning, sizing, shadow, animation

**Do NOT change:**
- Any Framer Motion code (useTransform, useSpring, animate props, variants)
- Spring physics parameters (mass, stiffness, damping)
- The bounce animation (translateY: [0, -20, 0])
- OpenPill animation (fade in with delay)
- Any click handlers or event logic
- Component exports or props interfaces
  </action>
  <verify>
Grep for `bg-surface-2` in dock-item.tsx to confirm semantic surface token on icon container.
Grep for `border-border-emphasis` in dock-item.tsx to confirm semantic border token.
Grep for `rounded-radius-lg` in dock-item.tsx to confirm semantic radius.
Grep for `text-text-primary` in dock-item.tsx to confirm semantic text color on icons.
Grep for `bg-surface-3` in dock-item.tsx to confirm reduced glow opacity.
Grep for `bg-white` in dock-item.tsx to confirm OpenPill is still pure white.
Grep for `text-caption-sm` in notification-badge.tsx to confirm semantic typography.
Run `npx tsc --noEmit` in the ui package to verify compilation.
  </verify>
  <done>
Dock items use semantic tokens throughout: surface-2 for icon background, border-emphasis for icon border, text-primary for icon color, surface-3 for glow, radius-lg for corners. OpenPill kept as pure white. Notification badge uses caption-sm semantic typography. All Framer Motion animations and spring physics unchanged.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in ui package (no TypeScript errors)
2. Dock container: grep dock.tsx for `bg-surface-base`, `border-border-default`, `rounded-radius-xl`
3. Dock slimmer: desktop padding is 10 (not 12), `px-2.5` on dock container
4. Dock divider: `border-border-subtle` and `h-6` (shorter, subtler)
5. Dock items: grep dock-item.tsx for `bg-surface-2`, `border-border-emphasis`, `text-text-primary`, `rounded-radius-lg`
6. Dock glow: `bg-surface-3` instead of raw `bg-white/20`
7. OpenPill: still `bg-white` (not migrated, intentional)
8. Notification badge: `text-caption-sm` instead of `text-[11px]`
9. Icon size still 50px for desktop (unchanged)
10. Spring physics parameters unchanged (mass:0.1, stiffness:150, damping:10)
11. All Framer Motion animations functional (no class changes to animated elements' layout properties)
</verification>

<success_criteria>
- Dock has visually slimmer appearance through reduced padding (74px -> 70px height)
- All raw opacity class strings migrated to semantic tokens
- Framer Motion magnification, bounce, and enter animations completely untouched
- Divider is cleaner (subtler border, shorter height)
- Notification badge uses semantic typography
- TypeScript compilation succeeds
- No changes to component props, exports, or interaction behavior
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-02-desktop-shell/02-01-SUMMARY.md`
</output>
