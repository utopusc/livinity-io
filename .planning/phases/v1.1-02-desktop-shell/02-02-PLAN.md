---
phase: v1.1-02-desktop-shell
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/src/modules/desktop/header.tsx
  - livos/packages/ui/src/modules/desktop/desktop-content.tsx
  - livos/packages/ui/src/modules/desktop/desktop-misc.tsx
  - livos/packages/ui/src/modules/desktop/app-grid/app-grid.tsx
  - livos/packages/ui/src/modules/desktop/app-grid/paginator.tsx
  - livos/packages/ui/src/modules/desktop/app-icon.tsx
  - livos/packages/ui/src/modules/desktop/install-first-app.tsx
autonomous: true

must_haves:
  truths:
    - "Desktop header greeting uses semantic heading/display typography instead of raw text-19 and text-5xl"
    - "App icons use semantic tokens for background, ring, border-radius, and label text sizes"
    - "Paginator arrow buttons use semantic surface/text tokens instead of raw bg-white/5"
    - "Paginator pills use semantic border-emphasis token for inactive state"
    - "Search button uses semantic surface/border/text tokens instead of raw opacity values"
    - "Install-first-app cards use semantic tokens for typography and hover states"
    - "App grid layout CSS variables and pagination constants are unchanged (no grid breakage)"
  artifacts:
    - path: "livos/packages/ui/src/modules/desktop/header.tsx"
      provides: "Desktop greeting with semantic typography"
      contains: "text-heading"
    - path: "livos/packages/ui/src/modules/desktop/app-icon.tsx"
      provides: "App icon with semantic surface/border/text tokens"
      contains: "bg-surface-2"
    - path: "livos/packages/ui/src/modules/desktop/app-grid/paginator.tsx"
      provides: "Paginator with semantic surface/text tokens"
      contains: "bg-surface-base"
    - path: "livos/packages/ui/src/modules/desktop/desktop-misc.tsx"
      provides: "Search button with semantic tokens"
      contains: "border-border-subtle"
    - path: "livos/packages/ui/src/modules/desktop/install-first-app.tsx"
      provides: "Install-first-app with semantic tokens"
      contains: "text-heading"
  key_links:
    - from: "livos/packages/ui/src/modules/desktop/app-icon.tsx"
      to: "livos/packages/ui/tailwind.config.ts"
      via: "Semantic token classes for surface, border, text, radius"
      pattern: "(bg-surface-|border-border-|text-text-|text-caption|text-body|rounded-radius-)"
    - from: "livos/packages/ui/src/modules/desktop/app-grid/paginator.tsx"
      to: "livos/packages/ui/tailwind.config.ts"
      via: "Semantic surface/text tokens for buttons and pills"
      pattern: "(bg-surface-|text-text-|bg-border-)"
    - from: "livos/packages/ui/src/modules/desktop/app-grid/app-grid.tsx"
      to: "livos/packages/ui/src/modules/desktop/app-grid/app-pagination-utils.tsx"
      via: "CSS variables for grid layout (--app-x-gap, --app-y-gap, etc.)"
      pattern: "var\\(--app-"
---

<objective>
Migrate the desktop content layer to semantic tokens: header/greeting typography, app grid paginator, app icon styling, search button, and install-first-app cards. This covers requirements DD-02 (improved grid spacing/alignment) and DD-03 (minimal typography).

Purpose: The desktop content layer is what users see behind the dock — the greeting, app grid, and search. Migrating these to semantic tokens creates visual consistency with the Phase 1 design system while keeping the existing layout structure intact.

Output: Updated header.tsx, desktop-content.tsx, desktop-misc.tsx, app-grid.tsx, paginator.tsx, app-icon.tsx, and install-first-app.tsx with semantic tokens.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-02-desktop-shell/02-RESEARCH.md
@.planning/phases/v1.1-01-design-system/01-01-SUMMARY.md

@livos/packages/ui/tailwind.config.ts
@livos/packages/ui/src/modules/desktop/header.tsx
@livos/packages/ui/src/modules/desktop/desktop-content.tsx
@livos/packages/ui/src/modules/desktop/desktop-misc.tsx
@livos/packages/ui/src/modules/desktop/app-grid/app-grid.tsx
@livos/packages/ui/src/modules/desktop/app-grid/paginator.tsx
@livos/packages/ui/src/modules/desktop/app-grid/app-pagination-utils.tsx
@livos/packages/ui/src/modules/desktop/app-icon.tsx
@livos/packages/ui/src/modules/desktop/install-first-app.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate header, search button, and desktop content typography</name>
  <files>livos/packages/ui/src/modules/desktop/header.tsx, livos/packages/ui/src/modules/desktop/desktop-misc.tsx, livos/packages/ui/src/modules/desktop/desktop-content.tsx</files>
  <action>
**header.tsx — migrate typography (line ~19):**
Current:
```
<h1 className='text-center text-19 font-bold md:text-5xl'>{greetingMessage(name)}</h1>
```

New:
```
<h1 className='text-center text-heading font-bold md:text-display-lg'>{greetingMessage(name)}</h1>
```

Changes:
- `text-19` -> `text-heading` (19px with line-height 1.3, letter-spacing 0, font-weight 600 — but we keep explicit `font-bold` which overrides the 600 weight to 700)
- `md:text-5xl` -> `md:text-display-lg` (48px with line-height 1.1, letter-spacing -0.03em, font-weight 700 — includes bold weight)

Keep everything else unchanged (the `cn()` with visibility logic, the gap classes, the LivinityLogo).

**desktop-misc.tsx — migrate search button (line ~12):**
Current:
```
z-10 select-none rounded-full border border-white/5 bg-neutral-600/20 px-3 py-2.5 text-12 leading-inter-trimmed text-white/90 backdrop-blur-sm transition-colors delay-300 duration-300 animate-in fade-in fill-mode-both hover:bg-neutral-600/30 active:bg-neutral-600/10
```

New:
```
z-10 select-none rounded-full border border-border-subtle bg-surface-1 px-3 py-2.5 text-caption leading-inter-trimmed text-text-primary backdrop-blur-sm transition-colors delay-300 duration-300 animate-in fade-in fill-mode-both hover:bg-surface-2 active:bg-surface-base
```

Changes:
- `border-white/5` -> `border-border-subtle` (0.06 vs 0.05, very close)
- `bg-neutral-600/20` -> `bg-surface-1` (semantic surface instead of hardcoded neutral)
- `text-12` -> `text-caption` (12px with line-height)
- `text-white/90` -> `text-text-primary` (0.90, same)
- `hover:bg-neutral-600/30` -> `hover:bg-surface-2` (semantic hover)
- `active:bg-neutral-600/10` -> `active:bg-surface-base` (semantic active)

**desktop-misc.tsx — keyboard shortcut hint (line ~16):**
Current:
```
text-white/20
```

New:
```
text-text-tertiary
```

Changes:
- `text-white/20` -> `text-text-tertiary` (0.40 vs 0.20 — tertiary is more visible, which is fine for a keyboard hint that should be readable)

**desktop-content.tsx — no token changes needed:**
The desktop-content.tsx classes are pure layout (flex, h-full, w-full, pt-6, overflow-hidden). These don't contain raw color/text/border tokens. Leave unchanged. The spacing values (pt-6, pt-8) are standard Tailwind spacing, not custom tokens to migrate.

**Do NOT change:**
- The AppGridGradientMasking component in desktop-misc.tsx (uses wallpaper image for functional masking)
- Any layout structure or Framer Motion animation props in desktop-content.tsx
- The greeting-message.ts logic
  </action>
  <verify>
Grep for `text-heading` in header.tsx to confirm semantic typography.
Grep for `text-display-lg` in header.tsx to confirm responsive display size.
Grep for `bg-surface-1` in desktop-misc.tsx to confirm search button surface token.
Grep for `border-border-subtle` in desktop-misc.tsx to confirm search button border.
Grep for `text-caption` in desktop-misc.tsx to confirm search button typography.
Grep for `text-text-tertiary` in desktop-misc.tsx to confirm keyboard hint.
Run `npx tsc --noEmit` in the ui package.
  </verify>
  <done>
Header greeting uses semantic typography (text-heading, md:text-display-lg). Search button uses semantic surface/border/text tokens. Keyboard shortcut hint uses text-tertiary. Desktop content layout unchanged.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate app icon, paginator, and install-first-app to semantic tokens</name>
  <files>livos/packages/ui/src/modules/desktop/app-icon.tsx, livos/packages/ui/src/modules/desktop/app-grid/paginator.tsx, livos/packages/ui/src/modules/desktop/app-grid/app-grid.tsx, livos/packages/ui/src/modules/desktop/install-first-app.tsx</files>
  <action>
**app-icon.tsx — icon container (line ~71-72):**
Current:
```
relative aspect-square w-12 shrink-0 overflow-hidden rounded-10 bg-white/10 bg-cover bg-center ring-white/25 backdrop-blur-sm transition-all duration-300 group-hover:scale-110 group-hover:ring-6 group-focus-visible:ring-6 group-active:scale-95 group-data-[state=open]:ring-6 md:w-16 md:rounded-15
```

New:
```
relative aspect-square w-12 shrink-0 overflow-hidden rounded-radius-sm bg-surface-2 bg-cover bg-center ring-border-emphasis backdrop-blur-sm transition-all duration-300 group-hover:scale-110 group-hover:ring-6 group-focus-visible:ring-6 group-active:scale-95 group-data-[state=open]:ring-6 md:w-16 md:rounded-radius-md
```

Changes:
- `rounded-10` -> `rounded-radius-sm` (8px vs 10px — slightly tighter, more refined)
- `bg-white/10` -> `bg-surface-2` (0.10, same value)
- `ring-white/25` -> `ring-border-emphasis` (0.20 vs 0.25 — slightly subtler ring)
- `md:rounded-15` -> `md:rounded-radius-md` (12px vs 15px — aligns to design system grid)
- Keep all hover/focus/active states, transitions, and sizing

**app-icon.tsx — progress bar background (line ~90):**
Current:
```
relative h-1 w-[75%] overflow-hidden rounded-full bg-white/40
```

New:
```
relative h-1 w-[75%] overflow-hidden rounded-full bg-surface-3
```

Changes:
- `bg-white/40` -> `bg-surface-3` (0.14 vs 0.40 — but this is a background track for progress bar, surface-3 provides enough contrast against the icon)

NOTE: If surface-3 (0.14) looks too faint as a progress bar track, this is an acceptable tradeoff for consistency. The progress fill is bright enough to be visible regardless.

**app-icon.tsx — progress bar fill (line ~92-93):**
Current:
```
absolute inset-0 w-0 rounded-full bg-white/90 transition-[width] delay-200 duration-700 animate-in slide-in-from-left-full fill-mode-both
```

New:
```
absolute inset-0 w-0 rounded-full bg-text-primary transition-[width] delay-200 duration-700 animate-in slide-in-from-left-full fill-mode-both
```

Changes:
- `bg-white/90` -> `bg-text-primary` (0.90, same value — using text-primary as a background color since it maps to the same rgba)

**app-icon.tsx — indeterminate loader (line ~97):**
Current:
```
absolute inset-0 w-[30%] animate-sliding-loader rounded-full bg-white/90
```

New:
```
absolute inset-0 w-[30%] animate-sliding-loader rounded-full bg-text-primary
```

Changes:
- `bg-white/90` -> `bg-text-primary`

**app-icon.tsx — label (line ~109):**
Current:
```
max-w-full text-11 leading-normal drop-shadow-desktop-label md:text-13
```

New:
```
max-w-full text-caption-sm leading-normal drop-shadow-desktop-label md:text-body-sm
```

Changes:
- `text-11` -> `text-caption-sm` (11px)
- `md:text-13` -> `md:text-body-sm` (13px)
- Keep `leading-normal` (overrides the semantic line-height for label-specific needs)
- Keep `drop-shadow-desktop-label` (component-specific shadow)

**app-icon.tsx — app button wrapper (line ~48-49):**
Keep unchanged — this is pure layout (flex, gap, py, focus:outline-none) with no raw color tokens.

**paginator.tsx — arrow button (line ~92):**
Current:
```
shrink-0 w-10 h-10 rounded-full backdrop-blur-sm contrast-more:bg-neutral-800 contrast-more:backdrop-blur-none grid place-items-center bg-white/5 shadow-glass-button text-white/75 disabled:text-white/30 transition-all hover:bg-white/10 contrast-more:hover:bg-neutral-700 active:bg-white/5 cursor-default
```

New:
```
shrink-0 w-10 h-10 rounded-full backdrop-blur-sm contrast-more:bg-neutral-800 contrast-more:backdrop-blur-none grid place-items-center bg-surface-base shadow-glass-button text-text-secondary disabled:text-text-tertiary transition-all hover:bg-surface-2 contrast-more:hover:bg-neutral-700 active:bg-surface-base cursor-default
```

Changes:
- `bg-white/5` -> `bg-surface-base` (0.04 vs 0.05, close)
- `text-white/75` -> `text-text-secondary` (0.60 vs 0.75 — slightly more muted, cleaner)
- `disabled:text-white/30` -> `disabled:text-text-tertiary` (0.40 vs 0.30 — slightly more visible when disabled, acceptable)
- `hover:bg-white/10` -> `hover:bg-surface-2` (0.10, same)
- `active:bg-white/5` -> `active:bg-surface-base` (consistent with base)
- Keep `shadow-glass-button` (component-specific)
- Keep contrast-more: variants

**paginator.tsx — paginator pills (line ~106-108):**
Current inactive:
```
h-1 w-3 rounded-full bg-white/20 transition-all group-hover:bg-white/30
```
Current active:
```
w-5 bg-white
```

New inactive:
```
h-1 w-3 rounded-full bg-border-emphasis transition-all group-hover:bg-surface-3
```
New active:
```
w-5 bg-white
```

Changes:
- `bg-white/20` -> `bg-border-emphasis` (0.20, same value — using border-emphasis as a bg works since it's the same rgba)
- `group-hover:bg-white/30` -> `group-hover:bg-surface-3` (0.14 vs 0.30 — more subtle hover, but surface-3 is the right semantic level)
- Keep active pill as `bg-white` (pure white indicator, same as dock open pill)

**app-grid.tsx — paginator pills wrapper (line ~90):**
Current: `mb-6 mt-6`
Keep unchanged — standard spacing.

**install-first-app.tsx — migrate tokens:**

Card (line ~158):
Current:
```
rounded-20 backdrop-blur-2xl contrast-more:backdrop-blur-none bg-blend-soft-light bg-gradient-to-b from-black/50 via-black/50 to-black contrast-more:bg-neutral-800 px-4 py-8 shadow-dialog flex flex-col gap-4 min-w-0
```

New:
```
rounded-radius-xl backdrop-blur-md contrast-more:backdrop-blur-none bg-blend-soft-light bg-gradient-to-b from-black/50 via-black/50 to-black contrast-more:bg-neutral-800 px-4 py-8 shadow-elevation-lg flex flex-col gap-4 min-w-0
```

Changes:
- `rounded-20` -> `rounded-radius-xl` (20px)
- `backdrop-blur-2xl` -> `backdrop-blur-md` (reduce heavy glassmorphism per design direction)
- `shadow-dialog` -> `shadow-elevation-lg` (cleaner elevation)

Card heading (line ~160):
Current:
```
text-center text-19 font-bold leading-tight -tracking-2
```

New:
```
text-center text-heading font-bold leading-tight -tracking-2
```

Changes:
- `text-19` -> `text-heading` (19px)
- Keep `leading-tight` and `-tracking-2` (overrides semantic defaults for this specific context)

Page title (line ~34):
Current:
```
-translate-y-2 text-center text-3xl font-bold leading-tight -tracking-2 md:text-48
```

New:
```
-translate-y-2 text-center text-heading-lg font-bold leading-tight -tracking-2 md:text-display-lg
```

Changes:
- `text-3xl` -> `text-heading-lg` (24px vs 30px — closer to design system, md breakpoint still shows large)
- `md:text-48` -> `md:text-display-lg` (48px)

App store link button (line ~50):
Current:
```
h-[42px] px-5 py-4 text-14 backdrop-blur-md
```

New:
```
h-[42px] px-5 py-4 text-body backdrop-blur-md
```

Changes:
- `text-14` -> `text-body` (14px)

App row (line ~148):
Current:
```
flex w-full items-center gap-2.5 rounded-15 p-2 duration-300 hover:bg-white/4
```

New:
```
flex w-full items-center gap-2.5 rounded-radius-md p-2 duration-300 hover:bg-surface-base
```

Changes:
- `rounded-15` -> `rounded-radius-md` (12px vs 15px)
- `hover:bg-white/4` -> `hover:bg-surface-base` (0.04, same)

App name (line ~150):
Current:
```
text-15 font-semibold -tracking-3
```

New:
```
text-body-lg font-semibold -tracking-3
```

Changes:
- `text-15` -> `text-body-lg` (15px)

App description (line ~152):
Current:
```
w-full min-w-0 truncate text-13 opacity-50
```

New:
```
w-full min-w-0 truncate text-body-sm text-text-secondary
```

Changes:
- `text-13` -> `text-body-sm` (13px)
- `opacity-50` -> `text-text-secondary` (use semantic text color instead of opacity hack)

**Do NOT change:**
- app-pagination-utils.tsx (CSS variable constants — no tokens to migrate)
- app-grid.tsx layout structure or CSS variable references
- Any Framer Motion animation code in app-icon.tsx or app-grid.tsx
- Context menu integration in AppIconConnected (uses shared menu infrastructure)
- Any component props, exports, or interaction behavior
  </action>
  <verify>
Grep for `bg-surface-2` in app-icon.tsx to confirm icon container surface token.
Grep for `rounded-radius-sm` in app-icon.tsx to confirm mobile radius.
Grep for `md:rounded-radius-md` in app-icon.tsx to confirm desktop radius.
Grep for `text-caption-sm` in app-icon.tsx to confirm label typography.
Grep for `bg-surface-base` in paginator.tsx to confirm arrow button surface token.
Grep for `text-text-secondary` in paginator.tsx to confirm arrow button text color.
Grep for `bg-border-emphasis` in paginator.tsx to confirm inactive pill styling.
Grep for `border-border-subtle` in desktop-misc.tsx to confirm search button.
Grep for `rounded-radius-xl` in install-first-app.tsx to confirm card radius.
Grep for `text-heading` in install-first-app.tsx to confirm typography migration.
Grep for `text-text-secondary` in install-first-app.tsx to confirm description text.
Run `npx tsc --noEmit` in the ui package.
  </verify>
  <done>
App icon uses semantic tokens (surface-2, border-emphasis, radius-sm/md, caption-sm/body-sm). Paginator buttons use surface-base/surface-2 with text-secondary/tertiary. Paginator pills use border-emphasis. Install-first-app uses semantic typography and reduced backdrop blur. All layout CSS variables and grid structure unchanged.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in ui package
2. Header: `text-heading`, `md:text-display-lg` in header.tsx
3. Search button: `bg-surface-1`, `border-border-subtle`, `text-caption`, `text-text-primary` in desktop-misc.tsx
4. App icon container: `bg-surface-2`, `ring-border-emphasis`, `rounded-radius-sm`, `md:rounded-radius-md` in app-icon.tsx
5. App icon label: `text-caption-sm`, `md:text-body-sm` in app-icon.tsx
6. Paginator arrows: `bg-surface-base`, `text-text-secondary` in paginator.tsx
7. Paginator pills: `bg-border-emphasis` (inactive), `bg-white` (active) in paginator.tsx
8. Install-first-app: `rounded-radius-xl`, `text-heading`, `text-body-sm text-text-secondary` in install-first-app.tsx
9. No changes to app-pagination-utils.tsx CSS variable constants
10. All Framer Motion animations unchanged
</verification>

<success_criteria>
- All desktop content components migrated to semantic tokens
- Typography uses semantic scale (caption-sm, body-sm, body, heading, display-lg)
- Surface/border tokens replace all raw white/N opacity values
- App grid layout and pagination CSS variables untouched
- Install-first-app has reduced glassmorphism (backdrop-blur-md instead of 2xl)
- TypeScript compilation succeeds
- No changes to component behavior, props, or exports
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-02-desktop-shell/02-02-SUMMARY.md`
</output>
