---
phase: v1.1-08-mobile-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/src/routes/ai-chat/index.tsx
autonomous: true

must_haves:
  truths:
    - "AI Chat is usable on mobile viewports (375px+)"
    - "Conversation sidebar is accessible via a drawer on mobile"
    - "Chat messages and input are fully visible on mobile without horizontal overflow"
    - "User can switch between Chat and MCP views on mobile"
  artifacts:
    - path: "livos/packages/ui/src/routes/ai-chat/index.tsx"
      provides: "Mobile-responsive AI Chat with drawer sidebar"
      contains: "useIsMobile"
  key_links:
    - from: "livos/packages/ui/src/routes/ai-chat/index.tsx"
      to: "@/hooks/use-is-mobile"
      via: "useIsMobile hook import"
      pattern: "useIsMobile"
    - from: "livos/packages/ui/src/routes/ai-chat/index.tsx"
      to: "@/shadcn-components/ui/drawer"
      via: "Drawer component import for mobile sidebar"
      pattern: "Drawer"
---

<objective>
Make the AI Chat page fully responsive on mobile viewports.

Purpose: The AI Chat currently renders a fixed `w-64` sidebar at all viewport sizes, making it unusable on mobile (the 256px sidebar consumes most of a 375px screen). This plan adds mobile detection and replaces the always-visible sidebar with a drawer pattern on mobile, matching the established pattern used in Files.

Output: A mobile-responsive AI Chat where the sidebar is hidden on mobile and accessible via a hamburger/menu button in a mobile header, and the chat area uses responsive padding.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@livos/packages/ui/src/routes/ai-chat/index.tsx
@livos/packages/ui/src/hooks/use-is-mobile.ts
@livos/packages/ui/src/shadcn-components/ui/drawer.tsx
@livos/packages/ui/src/features/files/components/files-layout/index.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add mobile layout to AI Chat with drawer sidebar</name>
  <files>livos/packages/ui/src/routes/ai-chat/index.tsx</files>
  <action>
  Modify the AiChat component in `routes/ai-chat/index.tsx` to be mobile-responsive:

  1. **Add imports:**
     - Import `useIsMobile` from `@/hooks/use-is-mobile`
     - Import `Drawer, DrawerContent, DrawerTrigger` from `@/shadcn-components/ui/drawer`
     - Import `IconMenu2` from `@tabler/icons-react` (for hamburger icon)

  2. **Add mobile state to AiChat component:**
     - Add `const isMobile = useIsMobile()`
     - Add `const [sidebarOpen, setSidebarOpen] = useState(false)` for drawer state

  3. **Conditional sidebar rendering in the return JSX:**
     - On desktop (`!isMobile`): Keep the existing inline `<ConversationSidebar ... />` as-is
     - On mobile (`isMobile`): Wrap `ConversationSidebar` in a `<Drawer>` component:
       ```tsx
       {isMobile && (
         <Drawer open={sidebarOpen} onOpenChange={setSidebarOpen}>
           <DrawerContent fullHeight withScroll>
             <ConversationSidebar
               conversations={conversationsQuery.data || []}
               activeId={searchParams.get('conv')}
               onSelect={(id) => {
                 setSearchParams({conv: id})
                 setActiveView('chat')
                 setSidebarOpen(false)
               }}
               onNew={() => {
                 handleNewConversation()
                 setSidebarOpen(false)
               }}
               onDelete={handleDeleteConversation}
               activeView={activeView}
               onViewChange={setActiveView}
             />
           </DrawerContent>
         </Drawer>
       )}
       ```

  4. **Update ConversationSidebar for mobile compatibility:**
     - Change the outer div from `w-64 flex-shrink-0` to use conditional classes:
       - Desktop: keep `w-64 flex-shrink-0 border-r border-border-default`
       - Mobile: use `w-full` (fill the drawer), remove `border-r`
     - Accept an optional `className` prop on ConversationSidebar and use `cn()` to merge
     - Alternatively, accept an `isMobile` prop and conditionally apply classes

  5. **Add mobile chat header:**
     - When `isMobile` is true, render a header bar above the chat messages area with:
       - A hamburger menu button (IconMenu2, size 20) that calls `setSidebarOpen(true)`
       - "Liv AI" text label (text-body font-semibold text-text-primary)
       - A new conversation button (IconPlus, size 18)
     - Style: `flex items-center justify-between border-b border-border-default px-4 py-3 bg-surface-base`
     - Touch target: both buttons should be at least 44px tap area (use `p-2` on the buttons, giving ~40px, or explicit `h-11 w-11 flex items-center justify-center`)

  6. **Responsive padding on chat area:**
     - Change the messages container padding from `p-6` to `p-3 md:p-6`
     - Change the input area padding from `p-4` to `p-3 md:p-4`

  7. **Close drawer on conversation select:**
     - When `onSelect` is called on mobile, also call `setSidebarOpen(false)` to close the drawer
     - Already handled in step 3 above
  </action>
  <verify>
  - `npm run build` (or `pnpm build`) succeeds without errors from the UI package
  - Manually verify (or grep) that `useIsMobile` is imported and used in ai-chat/index.tsx
  - Grep for `Drawer` import in ai-chat/index.tsx
  - Grep for responsive padding: `p-3 md:p-6` in the messages area
  </verify>
  <done>
  - AI Chat renders without a sidebar on mobile viewports (< 1024px)
  - A mobile header with hamburger menu opens a drawer containing the sidebar
  - Conversation selection closes the drawer and navigates to the conversation
  - Chat area uses responsive padding (p-3 on mobile, p-6 on desktop)
  - Desktop layout is unchanged (sidebar remains inline at w-64)
  </done>
</task>

</tasks>

<verification>
- Build passes: `cd livos/packages/ui && pnpm build`
- Grep confirms `useIsMobile` usage: `grep -r "useIsMobile" src/routes/ai-chat/index.tsx`
- Grep confirms Drawer import: `grep -r "Drawer" src/routes/ai-chat/index.tsx`
- Grep confirms responsive padding: `grep -r "p-3 md:p-6" src/routes/ai-chat/index.tsx`
</verification>

<success_criteria>
- AI Chat page is fully usable on 375px viewport
- Sidebar hidden on mobile, accessible via drawer
- Desktop layout unchanged
- No TypeScript or build errors
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-08-mobile-polish/08-01-SUMMARY.md`
</output>
