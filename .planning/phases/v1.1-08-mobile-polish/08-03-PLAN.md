---
phase: v1.1-08-mobile-polish
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/src/shadcn-components/ui/sheet.tsx
  - livos/packages/ui/src/shadcn-components/ui/shared/dialog.ts
  - livos/packages/ui/src/components/ui/toast.tsx
  - livos/packages/ui/src/modules/desktop/dock-item.tsx
autonomous: true

must_haves:
  truths:
    - "Sheet backdrop-blur is reduced on mobile for smoother open/close animations"
    - "Dialog backdrop-blur is reduced on mobile for smoother rendering"
    - "GPU compositing hints are applied to backdrop-blur elements"
    - "Desktop blur intensities remain unchanged"
  artifacts:
    - path: "livos/packages/ui/src/shadcn-components/ui/sheet.tsx"
      provides: "Responsive backdrop-blur on sheet overlay and content"
      contains: "md:backdrop-blur"
    - path: "livos/packages/ui/src/shadcn-components/ui/shared/dialog.ts"
      provides: "Responsive backdrop-blur on dialog content"
      contains: "md:backdrop-blur-2xl"
    - path: "livos/packages/ui/src/components/ui/toast.tsx"
      provides: "GPU-promoted toast backdrop"
      contains: "transform-gpu"
    - path: "livos/packages/ui/src/modules/desktop/dock-item.tsx"
      provides: "GPU-promoted dock item backdrop"
      contains: "transform-gpu"
  key_links:
    - from: "livos/packages/ui/src/shadcn-components/ui/sheet.tsx"
      to: "all sheet consumers"
      via: "SheetOverlay and SheetContent components"
      pattern: "backdrop-blur"
    - from: "livos/packages/ui/src/shadcn-components/ui/shared/dialog.ts"
      to: "~60 dialog consumers"
      via: "dialogContentClass export"
      pattern: "dialogContentClass"
---

<objective>
Optimize backdrop-blur performance on mobile by reducing blur intensity at mobile breakpoints and adding GPU compositing hints.

Purpose: Research identified 24 files using backdrop-blur with intensities up to 180px (3xl). These cause paint storms on mobile GPUs, leading to janky scrolling and animation stuttering during sheet/dialog open/close. The dock already uses `transform-gpu` and `contrast-more:backdrop-blur-none` as the reference pattern. This plan extends that optimization to the highest-impact backdrop-blur elements.

Output: Reduced blur on mobile for sheet, dialog overlay, and toast; GPU compositing hints on backdrop-blur containers that lack them.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@livos/packages/ui/src/shadcn-components/ui/sheet.tsx
@livos/packages/ui/src/shadcn-components/ui/shared/dialog.ts
@livos/packages/ui/src/components/ui/toast.tsx
@livos/packages/ui/src/modules/desktop/dock-item.tsx
@livos/packages/ui/src/modules/desktop/dock.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Reduce backdrop-blur on mobile for sheet and dialog</name>
  <files>
    livos/packages/ui/src/shadcn-components/ui/sheet.tsx
    livos/packages/ui/src/shadcn-components/ui/shared/dialog.ts
  </files>
  <action>
  Reduce backdrop-blur intensity on mobile for the two highest-impact elements (sheet and dialog), which are the most frequently opened overlays.

  **1. sheet.tsx — Sheet overlay (line ~23):**
  The SheetOverlay has `backdrop-blur-xl`. Change to responsive:
  - Current: `backdrop-blur-xl`
  - New: `backdrop-blur-lg md:backdrop-blur-xl`
  (Reduce from xl/20px to lg/12px on mobile. Also add `transform-gpu` to promote to GPU layer.)

  **2. sheet.tsx — Sheet content backdrop (line ~84):**
  The inner blur div has `backdrop-blur-3xl` (180px blur — extremely heavy). Change to responsive:
  - Current: `backdrop-blur-3xl`
  - New: `backdrop-blur-xl md:backdrop-blur-3xl`
  (Reduce from 3xl/64px to xl/20px on mobile. 180px blur is overkill for mobile GPUs.)
  Also add `transform-gpu` to this div.

  **3. shared/dialog.ts — dialogContentClass:**
  The dialog content uses `backdrop-blur-2xl` (40px blur). Change to responsive:
  - Current: `backdrop-blur-2xl contrast-more:backdrop-blur-none`
  - New: `backdrop-blur-lg md:backdrop-blur-2xl contrast-more:backdrop-blur-none`
  (Reduce from 2xl/40px to lg/12px on mobile.)
  Also add `transform-gpu` to the class string.

  **Why these specific reductions:**
  - 3xl (64px) -> xl (20px): Sheet content is the heaviest blur element. 64px is overkill on small screens where less background is visible through the translucent overlay.
  - 2xl (40px) -> lg (12px): Dialog content is the second-heaviest. 12px blur is still visually effective on small screens.
  - xl (20px) -> lg (12px): Sheet overlay is lighter but still benefits from reduction.

  **Elements NOT changed (and why):**
  - Dock (`dock.tsx`): Already has `transform-gpu` and `contrast-more:backdrop-blur-none`. The dock's `backdrop-blur-2xl` is acceptable because it's a static element (not animated in/out).
  - Window chrome (`window-chrome.tsx`): Uses `backdrop-blur-lg` (12px) and windows are desktop-only (never rendered on mobile).
  - Command palette (`command.tsx`): Uses `backdrop-blur-xl` on overlay only. Not a frequently animated element.
  - Immersive dialog (`immersive-dialog.tsx`): Already has `contrast-more:backdrop-blur-none`. Its `backdrop-blur-xl` is on the overlay (lighter).
  - ai-quick.tsx: Same as immersive dialog overlay pattern.
  </action>
  <verify>
  - `cd livos/packages/ui && pnpm build` succeeds
  - Grep for `md:backdrop-blur-3xl` in sheet.tsx (sheet content responsive)
  - Grep for `md:backdrop-blur-xl` in sheet.tsx (sheet overlay responsive)
  - Grep for `md:backdrop-blur-2xl` in shared/dialog.ts (dialog responsive)
  - Grep for `transform-gpu` in sheet.tsx and shared/dialog.ts
  </verify>
  <done>
  - Sheet content blur: 20px on mobile, 64px on desktop
  - Sheet overlay blur: 12px on mobile, 20px on desktop
  - Dialog content blur: 12px on mobile, 40px on desktop
  - `transform-gpu` added to sheet and dialog backdrop elements
  - Desktop visual appearance unchanged
  </done>
</task>

<task type="auto">
  <name>Task 2: Add transform-gpu to toast and dock-item backdrop elements</name>
  <files>
    livos/packages/ui/src/components/ui/toast.tsx
    livos/packages/ui/src/modules/desktop/dock-item.tsx
  </files>
  <action>
  Add `transform-gpu` to remaining backdrop-blur elements that lack it, to promote them to GPU compositing layers for smoother rendering.

  **1. toast.tsx (line ~22):**
  The toast uses `backdrop-blur-md`. Add `transform-gpu`:
  - Current: `bg-surface-3 rounded-radius-md py-4 px-5 backdrop-blur-md flex items-center gap-2 shadow-elevation-lg text-body-lg text-text-primary -tracking-4 w-full`
  - New: Add `transform-gpu` to the class string (anywhere in the string, conventionally near the backdrop-blur class)

  **2. dock-item.tsx (line ~130):**
  The dock item uses `backdrop-blur-md`. Add `transform-gpu`:
  - Current class contains `bg-surface-2 backdrop-blur-md border border-border-emphasis`
  - New: Add `transform-gpu` after `backdrop-blur-md`

  **Why transform-gpu:**
  The `transform-gpu` utility forces the browser to create a compositing layer for the element, using the GPU for painting instead of the CPU. This is especially beneficial for elements with backdrop-blur because:
  - CPU-painted blur is re-rasterized on every frame during animations
  - GPU-composited blur is rasterized once and composited cheaply
  - The dock already uses this pattern successfully (`dockClass` has `will-change-transform transform-gpu`)
  </action>
  <verify>
  - `cd livos/packages/ui && pnpm build` succeeds
  - Grep for `transform-gpu` in toast.tsx
  - Grep for `transform-gpu` in dock-item.tsx
  - Total `transform-gpu` count across codebase should be 5+ (dock, sheet x2, dialog, toast, dock-item)
  </verify>
  <done>
  - Toast has `transform-gpu` for GPU-composited backdrop blur
  - Dock item has `transform-gpu` for GPU-composited backdrop blur
  - No visual changes — purely a performance optimization
  - No build errors
  </done>
</task>

</tasks>

<verification>
- Build passes: `cd livos/packages/ui && pnpm build`
- Grep confirms responsive blur classes in sheet.tsx and dialog.ts
- Grep confirms `transform-gpu` in sheet.tsx, dialog.ts, toast.tsx, dock-item.tsx
- Desktop blur intensities preserved via `md:` prefix
</verification>

<success_criteria>
- Backdrop-blur reduced on mobile for sheet and dialog (highest-impact elements)
- GPU compositing hints added to backdrop-blur containers
- Desktop visual appearance unchanged
- No TypeScript or build errors
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-08-mobile-polish/08-03-SUMMARY.md`
</output>
