---
phase: v1.1-01-design-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/tailwind.config.ts
  - livos/packages/ui/src/index.css
  - livos/packages/ui/src/shadcn-lib/utils.ts
autonomous: true

must_haves:
  truths:
    - "Semantic color tokens (surface-base/1/2/3, border-subtle/default/emphasis, text-primary/secondary/tertiary) are available as Tailwind utilities"
    - "Typography scale has clear semantic levels (caption, body, heading, display) instead of raw pixel numbers"
    - "Shadow system is consolidated to 4 purposeful levels (sm/md/lg/xl) plus component-specific shadows"
    - "Border radii consolidated to 5 semantic levels (sm/md/lg/xl/full) instead of 18 numeric values"
    - "Icon size tokens (icon-sm/md/lg) exist for consistent sizing"
    - "Brand colors (brand, brand-lighter, brand-lightest) still work via CSS variables from wallpaper provider"
  artifacts:
    - path: "livos/packages/ui/tailwind.config.ts"
      provides: "All design tokens: colors, typography, shadows, radii, icon sizes"
      contains: "surface-base"
    - path: "livos/packages/ui/src/index.css"
      provides: "Global styles updated with semantic token references"
      contains: "text-primary"
    - path: "livos/packages/ui/src/shadcn-lib/utils.ts"
      provides: "Updated tw-merge config for semantic token classes"
      contains: "font-size"
  key_links:
    - from: "livos/packages/ui/tailwind.config.ts"
      to: "livos/packages/ui/src/providers/wallpaper.tsx"
      via: "CSS variables --color-brand, --color-brand-lighter, --color-brand-lightest"
      pattern: "hsl\\(var\\(--color-brand"
    - from: "livos/packages/ui/tailwind.config.ts"
      to: "livos/packages/ui/src/index.css"
      via: "Tailwind token classes used in global styles"
      pattern: "text-white/90|text-primary"
---

<objective>
Define the complete design token system in tailwind.config.ts — semantic colors, consolidated typography scale, reduced shadow system, standardized border radii, and icon sizing tokens.

Purpose: This is the foundation for the entire v1.1 UI redesign. Every subsequent phase depends on these tokens being defined correctly. The current system has token sprawl (18 border radii, 12+ font sizes, 12+ shadows) that needs consolidation into a systematic, semantic scale.

Output: Updated tailwind.config.ts with semantic tokens, updated index.css with semantic class references, updated utils.ts with tw-merge config for new token patterns.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-01-design-system/01-RESEARCH.md

@livos/packages/ui/tailwind.config.ts
@livos/packages/ui/src/index.css
@livos/packages/ui/src/shadcn-lib/utils.ts
@livos/packages/ui/src/providers/wallpaper.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define semantic design tokens in tailwind.config.ts</name>
  <files>livos/packages/ui/tailwind.config.ts</files>
  <action>
Overhaul the `theme.extend` section of tailwind.config.ts with the following changes. KEEP all existing keyframes, animations, and plugin config unchanged. KEEP the fontFamily, container, screens, flexShrink, backdropBlur, lineHeight, lineClamp, letterSpacing, ringWidth, aspectRatio, borderWidth, dropShadow, opacity, and typography sections unchanged.

**Colors** — ADD semantic tokens alongside existing brand colors. Do NOT remove existing colors (brand, brand-lighter, brand-lightest, destructive, destructive2, etc.) since they are used throughout the codebase. ADD these new semantic tokens:

```
// Semantic surface colors (dark theme, static)
'surface-base': 'rgba(255, 255, 255, 0.04)',
'surface-1': 'rgba(255, 255, 255, 0.06)',
'surface-2': 'rgba(255, 255, 255, 0.10)',
'surface-3': 'rgba(255, 255, 255, 0.14)',

// Semantic border colors
'border-subtle': 'rgba(255, 255, 255, 0.06)',
'border-default': 'rgba(255, 255, 255, 0.10)',
'border-emphasis': 'rgba(255, 255, 255, 0.20)',

// Semantic text colors
'text-primary': 'rgba(255, 255, 255, 0.90)',
'text-secondary': 'rgba(255, 255, 255, 0.60)',
'text-tertiary': 'rgba(255, 255, 255, 0.40)',
```

**fontSize** — ADD semantic font size tokens WITH line-height and letter-spacing. KEEP the existing numeric font sizes (9, 11, 12, 13, etc.) because they are used extensively across the codebase and removing them would break things. The old tokens will be deprecated gradually in later phases. Add:

```
// Caption level
'caption-sm': ['11px', { lineHeight: '1.4', letterSpacing: '0.01em' }],
'caption': ['12px', { lineHeight: '1.4', letterSpacing: '0.01em' }],

// Body level
'body-sm': ['13px', { lineHeight: '1.5', letterSpacing: '0.01em' }],
'body': ['14px', { lineHeight: '1.5', letterSpacing: '0.01em' }],
'body-lg': ['15px', { lineHeight: '1.5', letterSpacing: '0.01em' }],

// Heading level
'heading-sm': ['17px', { lineHeight: '1.3', letterSpacing: '0em', fontWeight: '600' }],
'heading': ['19px', { lineHeight: '1.3', letterSpacing: '0em', fontWeight: '600' }],
'heading-lg': ['24px', { lineHeight: '1.2', letterSpacing: '-0.01em', fontWeight: '600' }],

// Display level
'display-sm': ['32px', { lineHeight: '1.2', letterSpacing: '-0.02em', fontWeight: '700' }],
'display': ['36px', { lineHeight: '1.1', letterSpacing: '-0.02em', fontWeight: '700' }],
'display-lg': ['48px', { lineHeight: '1.1', letterSpacing: '-0.03em', fontWeight: '700' }],
```

**borderRadius** — ADD semantic radius tokens. KEEP existing numeric values for backward compatibility. Add:

```
'radius-sm': '8px',
'radius-md': '12px',
'radius-lg': '16px',
'radius-xl': '20px',
// 'full' already exists in Tailwind defaults
```

**boxShadow** — ADD 4 clean elevation shadows. KEEP existing component-specific shadows (dock, floating-island, widget, context-menu, dialog, etc.) since they are used in components not yet migrated. Add:

```
'elevation-sm': '0px 2px 8px rgba(0, 0, 0, 0.12)',
'elevation-md': '0px 4px 16px rgba(0, 0, 0, 0.16)',
'elevation-lg': '0px 8px 24px rgba(0, 0, 0, 0.20)',
'elevation-xl': '0px 16px 48px rgba(0, 0, 0, 0.24)',
```

**Icon sizing** — ADD a new `width`/`height` extension or add semantic icon size values. The simplest approach is to add them to a custom `iconSize` section that can be used as arbitrary values, but since Tailwind doesn't have a native `iconSize` utility, instead document the convention and add named spacing tokens that correspond to icon sizes:

In the `extend` section, add under a new `spacing` key (or append to existing if present):
```
spacing: {
  'icon-sm': '16px',
  'icon-md': '20px',
  'icon-lg': '24px',
},
```

This allows `w-icon-sm h-icon-sm`, `w-icon-md h-icon-md`, `w-icon-lg h-icon-lg` for consistent icon sizing.

**IMPORTANT CONSTRAINTS:**
- Do NOT remove any existing token values (backward compatibility during migration)
- Do NOT change the wallpaper/brand color CSS variable mechanism
- Do NOT modify plugins array
- Do NOT change keyframes or animations
- KEEP the numeric font size values alongside the new semantic ones
- KEEP the numeric border radius values alongside the new semantic ones
  </action>
  <verify>
Run `npx tsc --noEmit` in the ui package directory to verify no TypeScript errors in the config.
Grep for `surface-base` in tailwind.config.ts to confirm semantic colors exist.
Grep for `body-sm` in tailwind.config.ts to confirm semantic font sizes exist.
Grep for `radius-sm` in tailwind.config.ts to confirm semantic radii exist.
Grep for `elevation-sm` in tailwind.config.ts to confirm elevation shadows exist.
Grep for `icon-sm` in tailwind.config.ts to confirm icon spacing tokens exist.
  </verify>
  <done>
tailwind.config.ts has all semantic tokens defined: 10 surface/border/text colors, 11 typography sizes with line-height/letter-spacing, 4 semantic radii, 4 elevation shadows, 3 icon size spacings. All existing tokens remain for backward compatibility.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update index.css and utils.ts for new token system</name>
  <files>livos/packages/ui/src/index.css, livos/packages/ui/src/shadcn-lib/utils.ts</files>
  <action>
**index.css changes:**

Update the `html, body` rule to use semantic text color token instead of raw `text-white/90`:
- Change `@apply -tracking-3 text-white/90;` to `@apply -tracking-3 text-text-primary;`

This is a safe change because `text-primary` maps to `rgba(255, 255, 255, 0.90)` which is exactly `text-white/90`.

Do NOT change anything else in index.css. The scrollbar styles, keyframes, font imports, and utility classes all remain as-is.

**utils.ts changes:**

Update the `customTwMerge` configuration to handle the new semantic token patterns. The current config handles numeric font sizes (`text-12`) and numeric border radii (`rounded-12`). We need to add handling for:

1. Semantic font sizes — so that `cn('text-body', 'text-heading')` resolves correctly (heading wins). Add a string match for the semantic prefixes: `'caption-sm', 'caption', 'body-sm', 'body', 'body-lg', 'heading-sm', 'heading', 'heading-lg', 'display-sm', 'display', 'display-lg'`.

2. Semantic border radii — so that `cn('rounded-radius-sm', 'rounded-radius-lg')` resolves correctly. Add string matches for `'radius-sm', 'radius-md', 'radius-lg', 'radius-xl'`.

Update the `classGroups` to include these semantic tokens in their respective groups:

```typescript
const customTwMerge = extendTailwindMerge({
  classGroups: {
    'font-size': [{text: ['base', num, 'caption-sm', 'caption', 'body-sm', 'body', 'body-lg', 'heading-sm', 'heading', 'heading-lg', 'display-sm', 'display', 'display-lg']}],
    'border-radius': [{rounded: ['base', num, 'radius-sm', 'radius-md', 'radius-lg', 'radius-xl']}],
    'border-width': [{border: ['hpx']}],
  },
})
```

This ensures tailwind-merge correctly handles class precedence for both old numeric tokens and new semantic tokens.
  </action>
  <verify>
Grep for `text-text-primary` in index.css to confirm semantic token usage.
Grep for `caption-sm` in utils.ts to confirm tw-merge knows about semantic font sizes.
Grep for `radius-sm` in utils.ts to confirm tw-merge knows about semantic radii.
Run `npx tsc --noEmit` in the ui package to verify no TypeScript errors.
  </verify>
  <done>
index.css uses `text-text-primary` instead of raw `text-white/90`. utils.ts tw-merge config handles both old numeric tokens and new semantic tokens for font-size and border-radius class groups.
  </done>
</task>

</tasks>

<verification>
1. Verify tailwind.config.ts compiles without errors: `npx tsc --noEmit`
2. Verify all semantic color tokens present: grep for `surface-base`, `border-subtle`, `text-primary`
3. Verify all semantic typography tokens present: grep for `caption-sm`, `body`, `heading`, `display`
4. Verify semantic radii present: grep for `radius-sm`, `radius-md`, `radius-lg`, `radius-xl`
5. Verify elevation shadows present: grep for `elevation-sm`, `elevation-md`, `elevation-lg`, `elevation-xl`
6. Verify icon sizing tokens present: grep for `icon-sm`, `icon-md`, `icon-lg`
7. Verify brand colors preserved: grep for `hsl(var(--color-brand`
8. Verify existing numeric tokens NOT removed: grep for `fontSize.*9:` (old 9px token still exists)
9. Verify utils.ts handles semantic tokens: grep for `caption-sm` in utils.ts
10. Build the UI package to confirm no compilation errors
</verification>

<success_criteria>
- tailwind.config.ts has complete semantic token system (colors, typography, shadows, radii, icon sizes)
- All existing tokens preserved for backward compatibility
- Brand color CSS variable mechanism unchanged
- index.css uses semantic text-text-primary token
- utils.ts tw-merge handles both old and new token patterns
- TypeScript compilation succeeds with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-01-design-system/01-01-SUMMARY.md`
</output>
