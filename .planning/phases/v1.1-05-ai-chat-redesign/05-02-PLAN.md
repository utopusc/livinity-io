---
phase: v1.1-05-ai-chat-redesign
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - livos/packages/ui/src/routes/ai-chat/index.tsx
  - livos/packages/ui/src/components/ai-quick.tsx
autonomous: true

must_haves:
  truths:
    - "Chat input area uses semantic surface-base container and surface-1 textarea background"
    - "Chat input focus uses brand-colored focus ring (focus-visible:border-brand focus-visible:ring-3 focus-visible:ring-brand/20)"
    - "Send button uses bg-brand instead of bg-violet-600"
    - "Empty state uses semantic text-secondary heading and text-tertiary description"
    - "Suggestion chips use semantic border-default, surface-base, and caption typography"
    - "Quick chat dialog uses semantic border/surface/text tokens"
    - "Quick chat send button uses bg-brand"
    - "Quick chat footer uses semantic tokens for kbd and text"
    - "MCP panel loading fallback uses text-text-tertiary"
  artifacts:
    - path: "livos/packages/ui/src/routes/ai-chat/index.tsx"
      provides: "AiChat component (empty state, input area, MCP fallback) with semantic tokens"
      contains: "bg-brand"
    - path: "livos/packages/ui/src/components/ai-quick.tsx"
      provides: "AiQuickDialog with semantic tokens matching main chat"
      contains: "bg-brand"
  key_links:
    - from: "index.tsx input textarea"
      to: "brand focus pattern"
      via: "focus-visible:border-brand class"
      pattern: "focus-visible:border-brand.*focus-visible:ring-3"
    - from: "ai-quick.tsx"
      to: "semantic tokens"
      via: "border-border-default, bg-surface-base, text-text-primary classes"
      pattern: "border-border-default"
---

<objective>
Migrate the chat input area, empty state, and MCP loading fallback in index.tsx (lines 240-458), plus the entire ai-quick.tsx quick chat dialog, to use semantic design tokens.

Purpose: Completes the main chat view migration (input is the primary interaction point, empty state is the first thing users see) and aligns the quick chat dialog with the same design language.

Output: index.tsx fully migrated (combined with Plan 01's top-half work). ai-quick.tsx fully migrated to semantic tokens.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-05-ai-chat-redesign/05-RESEARCH.md
@.planning/phases/v1.1-05-ai-chat-redesign/05-01-SUMMARY.md

Source files:
@livos/packages/ui/src/routes/ai-chat/index.tsx
@livos/packages/ui/src/components/ai-quick.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate empty state, chat input area, and MCP fallback in index.tsx (AC-03, AC-04)</name>
  <files>livos/packages/ui/src/routes/ai-chat/index.tsx</files>
  <action>
Migrate the AiChat component (lines 240-458). **Only modify className values, do not touch logic, state, props, or event handlers.** The `cn` import was already added by Plan 05-01.

**Empty state (lines 372-399):**

1. Container text color (line 372):
   - `text-white/30` -> `text-text-tertiary`

2. Brain icon container (line 373) — KEEP gradient:
   - `rounded-2xl` -> `rounded-radius-xl`
   - Keep `bg-gradient-to-br from-violet-500/20 to-blue-500/20` and `text-violet-400` (brand)

3. Heading (line 376):
   - `text-lg font-medium text-white/50` -> `text-heading-sm font-medium text-text-secondary`

4. Description (line 377):
   - `text-sm text-white/30` -> `text-body text-text-tertiary`

5. Suggestion chips (line 394):
   - `rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-xs text-white/40 transition-colors hover:border-white/20 hover:bg-white/10 hover:text-white/60`
   -> `rounded-radius-md border border-border-default bg-surface-base px-3 py-1.5 text-caption text-text-tertiary transition-colors hover:border-border-emphasis hover:bg-surface-1 hover:text-text-secondary`

**Chat input area (lines 415-440):**

1. Input container (line 415):
   - `border-t border-white/10 bg-black/20` -> `border-t border-border-default bg-surface-base`

2. Textarea (line 424):
   - `rounded-xl` -> `rounded-radius-md`
   - `border border-white/10 bg-white/5` -> `border border-border-default bg-surface-1`
   - `text-sm text-white placeholder-white/30` -> `text-body text-text-primary placeholder-text-tertiary`
   - `focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/25` -> `focus-visible:border-brand focus-visible:ring-3 focus-visible:ring-brand/20`

3. Send button (line 435):
   - `rounded-xl bg-violet-600` -> `rounded-radius-md bg-brand`
   - `hover:bg-violet-500 disabled:opacity-40 disabled:hover:bg-violet-600` -> `hover:bg-brand-lighter disabled:opacity-40 disabled:hover:bg-brand`

**MCP panel loading fallback (line 448):**

1. Loading spinner (line 448):
   - `text-white/30` -> `text-text-tertiary`
  </action>
  <verify>
Run `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` — no type errors.
Search file for `bg-violet-600` — should not exist (replaced with bg-brand).
Search file for `focus:border-violet` — should not exist (replaced with focus-visible:border-brand).
Search file for `bg-black/20` — should not exist.
Verify `focus-visible:border-brand` appears in textarea.
  </verify>
  <done>
Empty state uses semantic tokens with preserved brand gradient. Chat input uses brand focus pattern matching Phase 1. Send button uses bg-brand. Suggestion chips use semantic border/surface/text hierarchy. No raw white/XX or violet-specific values remain in lines 240-458 except brand elements.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate ai-quick.tsx quick chat dialog to semantic tokens</name>
  <files>livos/packages/ui/src/components/ai-quick.tsx</files>
  <action>
Migrate the entire ai-quick.tsx file to semantic tokens. This file already imports `cn` from `@/shadcn-lib/utils` (line 18). **Only modify className values, do not touch logic, state, props, or event handlers.**

**Dialog content container (lines 158-168):**

1. Border and background (line 162):
   - `border border-white/10 bg-neutral-900/95` -> `border border-border-subtle bg-dialog-content`
   (Use `bg-dialog-content` for consistency with Phase 3 dialog redesign. The `border-border-subtle` matches shared/dialog.ts convention.)

2. Keep `rounded-2xl` -> `rounded-radius-xl` for dialog radius.

**Input area (lines 171-201):**

1. Input area border (line 171):
   - `border-b border-white/10` -> `border-b border-border-default`

2. Input text (line 182):
   - `text-sm text-white placeholder-white/30` -> `text-body text-text-primary placeholder-text-tertiary`

3. Send button (lines 188-189):
   - `rounded-lg bg-violet-600 text-white transition-colors hover:bg-violet-500` -> `rounded-radius-sm bg-brand text-white transition-colors hover:bg-brand-lighter`

4. Close button (lines 196-197):
   - `rounded-lg text-white/30 transition-colors hover:bg-white/10 hover:text-white/60` -> `rounded-radius-sm text-text-tertiary transition-colors hover:bg-surface-2 hover:text-text-secondary`

**Status / Loading (lines 204-208):**

1. Status border (line 205):
   - `border-b border-white/10` -> `border-b border-border-default`

2. Status text (line 207):
   - `text-xs text-white/40` -> `text-caption text-text-tertiary`

**MiniToolCall component (lines 57-80):**

1. Tool card (line 60):
   - `rounded-lg border border-white/10 bg-white/5 text-xs` -> `rounded-radius-sm border border-border-default bg-surface-base text-caption`

2. Expand button hover (line 63):
   - `hover:bg-white/5` -> `hover:bg-surface-1`

3. Keep `text-blue-400` for tool name (line 67) — semantic tool accent.

4. Status badge (line 68) — convert to cn():
   - `text-[10px]` -> `text-caption-sm`
   - Keep `text-green-400` / `text-red-400`

5. Expanded section border (line 73):
   - `border-t border-white/10` -> `border-t border-border-default`

6. Expanded pre content (line 74):
   - `text-[11px] text-white/50` -> `text-caption-sm text-text-secondary`

**Tool calls section (line 216):**

1. Tool calls border (line 216):
   - `border-b border-white/10` -> `border-b border-border-default`

**Footer hint (lines 234-248):**

1. Footer container (line 234):
   - `text-[11px] text-white/20` -> `text-caption-sm text-text-tertiary`

2. Kbd elements (lines 236, 242):
   - `rounded border border-white/10 bg-white/5 px-1.5 py-0.5 font-mono text-[10px]` -> `rounded border border-border-default bg-surface-base px-1.5 py-0.5 font-mono text-caption-sm`

**Preserve:** Brand gradient on Liv icon (`from-violet-500/30 to-blue-500/30`), `text-violet-400` brand color, `text-violet-400` loading spinner color. Keep `prose prose-sm prose-invert` for markdown. Keep all animation classes.
  </action>
  <verify>
Run `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` — no type errors.
Search file for `bg-neutral-900` — should not exist (replaced with bg-dialog-content).
Search file for `bg-violet-600` — should not exist (replaced with bg-brand).
Search file for `white/10` — should not exist (replaced with semantic tokens).
Search file for `white/` — should only find brand gradients (violet-500/30, blue-500/30).
  </verify>
  <done>
ai-quick.tsx fully migrated to semantic tokens. Dialog uses bg-dialog-content and border-border-subtle matching Phase 3. Send button uses bg-brand. MiniToolCall matches index.tsx ToolCallDisplay styling. Footer uses semantic caption-sm and border-default. All raw opacity values replaced except brand gradients and status colors.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. `npx tsc --noEmit --project livos/packages/ui/tsconfig.json` passes
2. `grep -n 'white/' livos/packages/ui/src/routes/ai-chat/index.tsx` — entire file should only contain brand gradient values (violet-500/30, blue-500/30)
3. `grep -n 'white/' livos/packages/ui/src/components/ai-quick.tsx` — only brand gradient values
4. `grep 'focus-visible:border-brand' livos/packages/ui/src/routes/ai-chat/index.tsx` — present on textarea
5. `grep 'bg-brand' livos/packages/ui/src/routes/ai-chat/index.tsx` — present for send button
6. `grep 'bg-brand' livos/packages/ui/src/components/ai-quick.tsx` — present for send button
7. `grep 'bg-dialog-content' livos/packages/ui/src/components/ai-quick.tsx` — present on dialog content
</verification>

<success_criteria>
- Chat input textarea uses brand focus pattern (focus-visible:border-brand + ring-3 + ring-brand/20)
- Send buttons use bg-brand in both index.tsx and ai-quick.tsx
- Empty state uses semantic heading-sm, text-secondary, text-tertiary
- Suggestion chips use semantic border/surface/text hierarchy
- ai-quick.tsx dialog uses bg-dialog-content and border-border-subtle
- MiniToolCall styling matches ToolCallDisplay from Plan 01
- Footer kbd elements use semantic tokens
- No type errors introduced
- No raw white/XX opacity values remain (except brand gradients)
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-05-ai-chat-redesign/05-02-SUMMARY.md`
</output>
