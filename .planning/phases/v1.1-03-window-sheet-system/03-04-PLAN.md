---
phase: v1.1-03-window-sheet-system
plan: 04
type: execute
wave: 3
depends_on: ["03-01", "03-03"]
files_modified:
  - livos/packages/ui/src/components/ui/immersive-dialog.tsx
  - livos/packages/ui/src/providers/window-manager.tsx
  - livos/packages/ui/src/modules/window/window.tsx
  - livos/packages/ui/src/utils/dialog.ts
autonomous: true

must_haves:
  truths:
    - "ImmersiveDialog title uses semantic text-heading-lg instead of raw text-24"
    - "ImmersiveDialog description uses semantic text-body-lg text-text-tertiary instead of raw text-15 text-white/40"
    - "ImmersiveDialog body text uses semantic text-body-lg text-text-primary instead of raw text-15 text-white/90"
    - "ImmersiveDialog icon message containers use semantic rounded-radius-sm border-border-subtle bg-surface-base instead of raw rounded-10 border-white/4 bg-white/4"
    - "ImmersiveDialog icon circles use semantic rounded-radius-sm bg-surface-base instead of raw rounded-8 bg-white/4"
    - "ImmersiveDialog icon message text uses semantic text-body-sm and text-caption instead of raw text-13 and text-12"
    - "ImmersiveDialog separator uses semantic border-border-default instead of raw border-white/10"
    - "Window resize handles exist on edges and corners of the window body"
    - "Window resize updates window size in window-manager state via UPDATE_SIZE action"
    - "Sheet and dialog close animations are smoother with increased EXIT_DURATION_MS"
  artifacts:
    - path: "livos/packages/ui/src/components/ui/immersive-dialog.tsx"
      provides: "ImmersiveDialog with full semantic token migration"
      contains: "text-heading-lg"
    - path: "livos/packages/ui/src/providers/window-manager.tsx"
      provides: "Window manager with UPDATE_SIZE action and updateWindowSize context method"
      contains: "UPDATE_SIZE"
    - path: "livos/packages/ui/src/modules/window/window.tsx"
      provides: "Window with resize handles and resize interaction"
      contains: "handleResizeStart"
    - path: "livos/packages/ui/src/utils/dialog.ts"
      provides: "Increased EXIT_DURATION_MS for smoother close animations"
      contains: "EXIT_DURATION_MS = 150"
  key_links:
    - from: "livos/packages/ui/src/modules/window/window.tsx"
      to: "livos/packages/ui/src/providers/window-manager.tsx"
      via: "updateWindowSize from useWindowManager context"
      pattern: "updateWindowSize"
    - from: "livos/packages/ui/src/components/ui/immersive-dialog.tsx"
      to: "livos/packages/ui/src/shadcn-components/ui/shared/dialog.ts"
      via: "dialogContentClass import (already migrated in 03-01)"
      pattern: "dialogContentClass"
    - from: "livos/packages/ui/src/utils/dialog.ts"
      to: "livos/packages/ui/src/layouts/sheet.tsx"
      via: "useAfterDelayedClose uses EXIT_DURATION_MS"
      pattern: "EXIT_DURATION_MS"
---

<objective>
Migrate ImmersiveDialog to semantic tokens, add window resize handles (WS-04), and polish close animations (SM-04). This is the final plan covering the remaining requirements.

Purpose: ImmersiveDialog is the most complex dialog variant (271 lines, split content, AnimateIn, custom close button) and needs careful migration. Window resize is a new feature requiring state management changes and event handling. Animation polish ties everything together for a smoother overall feel.

Output: Fully migrated ImmersiveDialog, window-manager with resize support, window with resize handles, smoother exit animations.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-03-window-sheet-system/03-RESEARCH.md
@.planning/phases/v1.1-01-design-system/01-01-SUMMARY.md
@.planning/phases/v1.1-03-window-sheet-system/03-01-SUMMARY.md
@.planning/phases/v1.1-03-window-sheet-system/03-03-SUMMARY.md

@livos/packages/ui/tailwind.config.ts
@livos/packages/ui/src/components/ui/immersive-dialog.tsx
@livos/packages/ui/src/providers/window-manager.tsx
@livos/packages/ui/src/modules/window/window.tsx
@livos/packages/ui/src/utils/dialog.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate ImmersiveDialog to semantic tokens</name>
  <files>livos/packages/ui/src/components/ui/immersive-dialog.tsx</files>
  <action>
Migrate all raw class strings in immersive-dialog.tsx to semantic tokens. Preserve the Radix Dialog integration, Framer Motion AnimateIn, split content layout, size variants, and all component exports.

**immersive-dialog.tsx line 19 — immersiveDialogTitleClass:**
Current:
```
text-24 font-bold leading-none -tracking-4 text-white/80
```

New:
```
text-heading-lg font-bold leading-none -tracking-4 text-text-primary
```

Changes:
- `text-24` -> `text-heading-lg` (heading-lg = 24px)
- `text-white/80` -> `text-text-primary` (0.80 -> 0.90. Title should be prominent -- text-primary is the standard heading color.)
- Keep `font-bold` (override heading-lg default 600 weight to 700)
- Keep `leading-none` (override heading-lg default 1.2 line-height to 1.0 for tighter display)
- Keep `-tracking-4`

**immersive-dialog.tsx line 20 — immersiveDialogDescriptionClass:**
Current:
```
text-15 font-normal leading-tight -tracking-2 text-white/40
```

New:
```
text-body-lg leading-tight -tracking-2 text-text-tertiary
```

Changes:
- `text-15 font-normal` -> `text-body-lg` (body-lg = 15px, fontWeight 400)
- `text-white/40` -> `text-text-tertiary` (0.40, same value, semantic token)
- Keep `leading-tight` (override body-lg default 1.45 to tighter spacing)
- Keep `-tracking-2`

**immersive-dialog.tsx line 23 — ImmersiveDialogSeparator:**
Current:
```
w-full border-white/10
```

New:
```
w-full border-border-default
```

Changes:
- `border-white/10` -> `border-border-default` (0.10, same value, semantic token)

**immersive-dialog.tsx line 90 — ForwardedImmersiveDialogSplitContent ring:**
Current:
```
bg-transparent shadow-none ring-2 ring-white/3
```

New:
```
bg-transparent shadow-none ring-2 ring-border-subtle
```

Changes:
- `ring-white/3` -> `ring-border-subtle` (border-subtle is 0.06 vs 0.03. Slightly more visible ring on the split content container -- acceptable as the ring was barely visible at 0.03.)

**immersive-dialog.tsx line 98 — split content side section:**
Current:
```
hidden w-[210px] flex-col items-center justify-center bg-black/40 md:flex md:rounded-l-20
```

Keep unchanged. `bg-black/40` is an intentional semi-transparent black for the side panel (not a surface). `md:rounded-l-20` is a specific rounded value for the split layout.

**immersive-dialog.tsx line 101 — split content main section:**
Current:
```
flex-1 bg-dialog-content/70 max-md:rounded-20 md:rounded-r-20
```

Keep unchanged. `bg-dialog-content/70` is an intentional custom dialog background. The rounded values are specific to the split layout.

**immersive-dialog.tsx line 122 — ImmersiveDialogOverlay:**
Current:
```
bg-black/30 backdrop-blur-xl contrast-more:backdrop-blur-none
```

Keep unchanged. The overlay uses lighter bg-black/30 (vs standard dialog bg-black/60) and `backdrop-blur-xl` intentionally for the immersive effect. This is already a different class from the standard dialogOverlayClass.

**immersive-dialog.tsx line 137 — ImmersiveDialogClose button:**
Current:
```
h-[36px] w-[36px] border-none bg-dialog-content bg-opacity-70 shadow-immersive-dialog-close hover:border-solid hover:bg-dialog-content focus:border-solid focus:bg-dialog-content active:bg-dialog-content
```

Keep unchanged. This uses `bg-dialog-content` which is a specific dialog color (#1E1E1E). The `bg-opacity-70` is applied to that specific color. The `shadow-immersive-dialog-close` is a custom component shadow. These are all intentional component-specific values.

**immersive-dialog.tsx line 174 — bodyTextClass:**
Current:
```
text-15 font-medium leading-none -tracking-4 text-white/90
```

New:
```
text-body-lg font-medium leading-none -tracking-4 text-text-primary
```

Changes:
- `text-15` -> `text-body-lg` (body-lg = 15px)
- `text-white/90` -> `text-text-primary` (0.90, same value, semantic token)
- Keep `font-medium` (override body-lg default 400 to 500)
- Keep `leading-none` and `-tracking-4`

**immersive-dialog.tsx line 216 — ImmersiveDialogIconMessage container:**
Current:
```
inline-flex w-full items-center gap-2 rounded-10 border border-white/4 bg-white/4 p-2 text-left font-normal
```

New:
```
inline-flex w-full items-center gap-2 rounded-radius-sm border border-border-subtle bg-surface-base p-2 text-left font-normal
```

Changes:
- `rounded-10` -> `rounded-radius-sm` (10px -> 8px. Tighter radius for small containers, consistent with semantic system.)
- `border-white/4` -> `border-border-subtle` (0.04 -> 0.06. border-subtle is the lightest semantic border.)
- `bg-white/4` -> `bg-surface-base` (0.04, same value, semantic token)

**immersive-dialog.tsx line 223 — icon circle:**
Current:
```
flex h-8 w-8 shrink-0 items-center justify-center rounded-8 bg-white/4
```

New:
```
flex h-8 w-8 shrink-0 items-center justify-center rounded-radius-sm bg-surface-base
```

Changes:
- `rounded-8` -> `rounded-radius-sm` (8px, same value)
- `bg-white/4` -> `bg-surface-base` (0.04, same value, semantic token)

**immersive-dialog.tsx line 227 — icon message title:**
Current:
```
text-13 font-normal leading-tight -tracking-2
```

New:
```
text-body-sm leading-tight -tracking-2
```

Changes:
- `text-13 font-normal` -> `text-body-sm` (body-sm = 13px, fontWeight 400)
- Keep `leading-tight` and `-tracking-2`

**immersive-dialog.tsx line 229 — icon message description:**
Current:
```
text-12 font-normal leading-tight -tracking-2 text-white/50
```

New:
```
text-caption leading-tight -tracking-2 text-text-secondary
```

Changes:
- `text-12 font-normal` -> `text-caption` (caption = 12px, fontWeight 400)
- `text-white/50` -> `text-text-secondary` (0.50 -> 0.60, accepted visibility increase)
- Keep `leading-tight` and `-tracking-2`

**immersive-dialog.tsx line 254 — ImmersiveDialogIconMessageKeyValue container:**
Current:
```
inline-flex w-full items-center gap-2 rounded-10 border border-white/4 bg-white/4 px-3 py-2.5 text-left font-normal
```

New:
```
inline-flex w-full items-center gap-2 rounded-radius-sm border border-border-subtle bg-surface-base px-3 py-2.5 text-left font-normal
```

Changes:
- `rounded-10` -> `rounded-radius-sm` (same pattern as IconMessage)
- `border-white/4` -> `border-border-subtle` (same pattern)
- `bg-white/4` -> `bg-surface-base` (same pattern)

**immersive-dialog.tsx line 261 — KeyValue icon circle:**
Current:
```
flex h-8 w-8 shrink-0 items-center justify-center rounded-8 bg-white/4
```

New:
```
flex h-8 w-8 shrink-0 items-center justify-center rounded-radius-sm bg-surface-base
```

Changes:
- Same pattern as line 223.

**immersive-dialog.tsx line 264 — KeyValue text container:**
Current:
```
flex flex-1 text-14
```

New:
```
flex flex-1 text-body
```

Changes:
- `text-14` -> `text-body` (body = 14px)

**immersive-dialog.tsx line 265 — KeyValue key text:**
Current:
```
flex-1 font-normal leading-tight -tracking-2 opacity-60
```

New:
```
flex-1 font-normal leading-tight -tracking-2 text-text-secondary
```

Changes:
- `opacity-60` -> `text-text-secondary` (semantic token instead of generic opacity which affects the entire element)

**Do NOT change:**
- Radix Dialog integration (DialogContent, DialogPortal, DialogOverlay, DialogClose, DialogTrigger)
- Framer Motion AnimateIn component
- Size variants (sm, md, lg, xl)
- Short/tall content height classes
- ImmersiveDialogClose button styling (uses dialog-content color, not a generic surface)
- ImmersiveDialogOverlay (intentionally different from standard overlay)
- Split content side/main section backgrounds
- Inline boxShadow on icon message containers
- Component exports or props
  </action>
  <verify>
Grep for `text-heading-lg` in immersive-dialog.tsx to confirm semantic title.
Grep for `text-text-primary` in immersive-dialog.tsx to confirm semantic title color.
Grep for `text-body-lg` in immersive-dialog.tsx to confirm semantic description and body typography.
Grep for `text-text-tertiary` in immersive-dialog.tsx to confirm semantic description color.
Grep for `text-body-sm` in immersive-dialog.tsx to confirm semantic icon message title.
Grep for `text-caption` in immersive-dialog.tsx to confirm semantic icon message description.
Grep for `text-text-secondary` in immersive-dialog.tsx to confirm semantic colors.
Grep for `border-border-default` in immersive-dialog.tsx to confirm separator.
Grep for `border-border-subtle` in immersive-dialog.tsx to confirm icon message borders.
Grep for `bg-surface-base` in immersive-dialog.tsx to confirm icon message backgrounds.
Grep for `rounded-radius-sm` in immersive-dialog.tsx to confirm semantic radius.
Grep for `text-body` in immersive-dialog.tsx to confirm KeyValue text.
Grep for `text-24` in immersive-dialog.tsx to confirm raw size removed.
Grep for `text-white/80` in immersive-dialog.tsx to confirm raw color removed.
Grep for `text-white/40` in immersive-dialog.tsx to confirm raw color removed.
Grep for `text-white/90` in immersive-dialog.tsx to confirm raw color removed (bodyTextClass).
Grep for `bg-white/4` in immersive-dialog.tsx to confirm raw background removed.
Grep for `border-white/4` in immersive-dialog.tsx to confirm raw border removed.
Grep for `border-white/10` in immersive-dialog.tsx to confirm raw separator border removed.
Grep for `rounded-10` in immersive-dialog.tsx to confirm raw radius removed.
Grep for `rounded-8` in immersive-dialog.tsx to confirm raw radius removed.
Run `npx tsc --noEmit` in the ui package.
  </verify>
  <done>
ImmersiveDialog fully migrated to semantic tokens: title (text-heading-lg text-text-primary), description (text-body-lg text-text-tertiary), body text (text-body-lg text-text-primary), icon messages (rounded-radius-sm border-border-subtle bg-surface-base), icon text (text-body-sm, text-caption, text-text-secondary), separator (border-border-default), KeyValue (text-body, text-text-secondary). Component-specific values preserved (dialog-content backgrounds, immersive-dialog-close shadow, overlay, split content sections).
  </done>
</task>

<task type="auto">
  <name>Task 2: Add window resize handles and update EXIT_DURATION_MS for smoother animations</name>
  <files>livos/packages/ui/src/providers/window-manager.tsx, livos/packages/ui/src/modules/window/window.tsx, livos/packages/ui/src/utils/dialog.ts</files>
  <action>
Add window resize capability (WS-04) and increase exit animation duration (SM-04). This extends the existing window-manager reducer with an UPDATE_SIZE action and adds resize handle interaction to window.tsx.

**window-manager.tsx — Add UPDATE_SIZE action type (after line 105):**

Add to the WindowAction union type:
```typescript
| {type: 'UPDATE_SIZE'; payload: {id: WindowId; size: Size}}
```

**window-manager.tsx — Add UPDATE_SIZE case to reducer (after UPDATE_POSITION case, before default):**

```typescript
case 'UPDATE_SIZE':
    return {
        ...state,
        windows: state.windows.map((w) =>
            w.id === action.payload.id ? {...w, size: action.payload.size} : w,
        ),
    }
```

**window-manager.tsx — Add updateWindowSize to context type (after updateWindowPosition in WindowManagerContextT):**

```typescript
updateWindowSize: (windowId: WindowId, size: Size) => void
```

**window-manager.tsx — Add updateWindowSize callback (after updateWindowPosition callback):**

```typescript
const updateWindowSize = useCallback((windowId: WindowId, size: Size) => {
    dispatch({type: 'UPDATE_SIZE', payload: {id: windowId, size}})
}, [])
```

**window-manager.tsx — Add updateWindowSize to provider value (after updateWindowPosition):**

```typescript
updateWindowSize,
```

**window.tsx — Add resize state and handlers:**

Import updateWindowSize from useWindowManager. Add the following state and handlers alongside the existing drag state (after the drag-related useState/useRef declarations around lines 24-27):

```typescript
const [isResizing, setIsResizing] = useState(false)
const [resizeDirection, setResizeDirection] = useState<string>('')
const resizeStartPos = useRef({x: 0, y: 0})
const resizeStartSize = useRef({width: 0, height: 0})
const resizeStartPosition = useRef({x: 0, y: 0})
```

Update the destructuring from useWindowManager (line 23) to include updateWindowSize:
```typescript
const {closeWindow, focusWindow, updateWindowPosition, updateWindowSize} = useWindowManager()
```

Add resize start handler (after handleDragStart):
```typescript
const handleResizeStart = useCallback((e: React.MouseEvent, direction: string) => {
    e.preventDefault()
    e.stopPropagation()
    setIsResizing(true)
    setResizeDirection(direction)
    resizeStartPos.current = {x: e.clientX, y: e.clientY}
    resizeStartSize.current = {width: size.width, height: size.height}
    resizeStartPosition.current = {x: position.x, y: position.y}
    focusWindow(id)
}, [focusWindow, id, size.width, size.height, position.x, position.y])
```

Add resize mouse move handler (after handleMouseMove):
```typescript
const handleResizeMove = useCallback((e: MouseEvent) => {
    if (!isResizing) return

    const deltaX = e.clientX - resizeStartPos.current.x
    const deltaY = e.clientY - resizeStartPos.current.y

    let newWidth = resizeStartSize.current.width
    let newHeight = resizeStartSize.current.height
    let newX = resizeStartPosition.current.x
    let newY = resizeStartPosition.current.y

    // Apply delta based on resize direction
    if (resizeDirection.includes('e')) newWidth += deltaX
    if (resizeDirection.includes('w')) { newWidth -= deltaX; newX += deltaX }
    if (resizeDirection.includes('s')) newHeight += deltaY
    if (resizeDirection.includes('n')) { newHeight -= deltaY; newY += deltaY }

    // Enforce minimum size (400x400 matches getResponsiveSize minimum)
    newWidth = Math.max(400, newWidth)
    newHeight = Math.max(400, newHeight)

    updateWindowSize(id, {width: newWidth, height: newHeight})
    // Update position for north/west resizing (window origin moves)
    if (resizeDirection.includes('n') || resizeDirection.includes('w')) {
        updateWindowPosition(id, {x: newX, y: newY})
    }
}, [isResizing, resizeDirection, id, updateWindowSize, updateWindowPosition])
```

Add resize mouse up handler (after handleMouseUp):
```typescript
const handleResizeUp = useCallback(() => {
    if (!isResizing) return
    setIsResizing(false)
    setResizeDirection('')
}, [isResizing])
```

Update the existing useEffect for global mouse events (lines 62-76) to also handle resize events. Replace the current useEffect with:
```typescript
useEffect(() => {
    if (isDragging) {
        document.addEventListener('mousemove', handleMouseMove)
        document.addEventListener('mouseup', handleMouseUp)
        document.body.style.cursor = 'grabbing'
        document.body.style.userSelect = 'none'
    } else if (isResizing) {
        document.addEventListener('mousemove', handleResizeMove)
        document.addEventListener('mouseup', handleResizeUp)
        const cursorMap: Record<string, string> = {
            n: 'ns-resize', s: 'ns-resize', e: 'ew-resize', w: 'ew-resize',
            ne: 'nesw-resize', sw: 'nesw-resize', nw: 'nwse-resize', se: 'nwse-resize',
        }
        document.body.style.cursor = cursorMap[resizeDirection] || 'se-resize'
        document.body.style.userSelect = 'none'
    }

    return () => {
        document.removeEventListener('mousemove', handleMouseMove)
        document.removeEventListener('mouseup', handleMouseUp)
        document.removeEventListener('mousemove', handleResizeMove)
        document.removeEventListener('mouseup', handleResizeUp)
        document.body.style.cursor = ''
        document.body.style.userSelect = ''
    }
}, [isDragging, isResizing, handleMouseMove, handleMouseUp, handleResizeMove, handleResizeUp, resizeDirection])
```

Add resize handles to the window body motion.div. Inside the window body motion.div (after the `<div className={windowContentClass}>{children}</div>` on line 131), add:

```tsx
{/* Resize handles */}
{/* Edge handles */}
<div className='absolute inset-x-2 top-0 h-1 cursor-ns-resize' onMouseDown={(e) => handleResizeStart(e, 'n')} />
<div className='absolute inset-x-2 bottom-0 h-1 cursor-ns-resize' onMouseDown={(e) => handleResizeStart(e, 's')} />
<div className='absolute inset-y-2 left-0 w-1 cursor-ew-resize' onMouseDown={(e) => handleResizeStart(e, 'w')} />
<div className='absolute inset-y-2 right-0 w-1 cursor-ew-resize' onMouseDown={(e) => handleResizeStart(e, 'e')} />
{/* Corner handles */}
<div className='absolute left-0 top-0 h-3 w-3 cursor-nwse-resize' onMouseDown={(e) => handleResizeStart(e, 'nw')} />
<div className='absolute right-0 top-0 h-3 w-3 cursor-nesw-resize' onMouseDown={(e) => handleResizeStart(e, 'ne')} />
<div className='absolute bottom-0 left-0 h-3 w-3 cursor-nesw-resize' onMouseDown={(e) => handleResizeStart(e, 'sw')} />
<div className='absolute bottom-0 right-0 h-3 w-3 cursor-nwse-resize' onMouseDown={(e) => handleResizeStart(e, 'se')} />
```

These are invisible hotspot divs at the edges and corners. No visible styling needed -- the cursor change provides visual feedback. Edge handles are 4px (h-1/w-1) with 8px (inset-2) margin from corners. Corner handles are 12px (h-3 w-3) squares at each corner.

**dialog.ts line 9 — EXIT_DURATION_MS:**
Current:
```
export const EXIT_DURATION_MS = 100
```

New:
```
export const EXIT_DURATION_MS = 150
```

Changes:
- `100` -> `150` (50% longer exit delay for smoother feel on sheet/dialog close animations. Not too long -- at 100ms the navigation could fire before the close animation visually completed, 150ms gives enough time for the fade/zoom-out to be perceived without feeling sluggish. The CSS animations are `data-[state=closed]:duration-100` (100ms) so 150ms provides a safe 50ms buffer.)

**Do NOT change:**
- Window drag mechanics (handleDragStart, handleMouseMove, handleMouseUp)
- Framer Motion animation values (initial, animate, exit, transition)
- Window position clamping logic
- WindowManagerProvider structure beyond adding the new action
- getResponsiveSize or DEFAULT_WINDOW_SIZES
- getInitialPosition logic
- Any other exports from dialog.ts (afterDelayedClose, useAfterDelayedClose, useDialogOpenProps, useLinkToDialog)
- dialog.ts type definitions (DialogKey union type)
  </action>
  <verify>
Grep for `UPDATE_SIZE` in window-manager.tsx to confirm new action type and reducer case.
Grep for `updateWindowSize` in window-manager.tsx to confirm callback and context value.
Grep for `updateWindowSize` in window.tsx to confirm it is destructured from useWindowManager.
Grep for `handleResizeStart` in window.tsx to confirm resize handler exists.
Grep for `isResizing` in window.tsx to confirm resize state exists.
Grep for `cursor-nwse-resize` in window.tsx to confirm corner resize handles exist.
Grep for `cursor-ns-resize` in window.tsx to confirm edge resize handles exist.
Grep for `EXIT_DURATION_MS = 150` in dialog.ts to confirm increased duration.
Verify `Math.max(400` appears in window.tsx resize handler (minimum size enforcement).
Run `npx tsc --noEmit` in the ui package.
  </verify>
  <done>
Window resize system complete: UPDATE_SIZE action in window-manager reducer, updateWindowSize in context, resize handles on all edges and corners of window body with appropriate cursor feedback, minimum 400x400 size constraint, north/west resize updates position to keep opposite corner fixed. EXIT_DURATION_MS increased from 100ms to 150ms for smoother sheet/dialog close animations with safe buffer above CSS animation duration.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in ui package
2. immersive-dialog.tsx: `text-heading-lg`, `text-text-primary`, `text-body-lg`, `text-text-tertiary`, `text-body-sm`, `text-caption`, `text-text-secondary`, `border-border-default`, `border-border-subtle`, `bg-surface-base`, `rounded-radius-sm`, `text-body` present
3. immersive-dialog.tsx: `text-24`, `text-white/80`, `text-white/40`, `text-white/90`, `text-15`, `text-13`, `text-12`, `border-white/10`, `border-white/4`, `bg-white/4`, `rounded-10`, `rounded-8`, `opacity-60` absent (check each individually)
4. immersive-dialog.tsx: `bg-dialog-content`, `shadow-immersive-dialog-close`, `bg-black/40`, `bg-black/30`, `backdrop-blur-xl` preserved on close button and overlay
5. window-manager.tsx: `UPDATE_SIZE` action type, reducer case, `updateWindowSize` callback and context value
6. window.tsx: Resize handles (8 divs with cursor-*-resize classes), `handleResizeStart`, `handleResizeMove`, `handleResizeUp`, `isResizing` state
7. window.tsx: Minimum size `Math.max(400,` in resize handler
8. dialog.ts: `EXIT_DURATION_MS = 150`
9. All Framer Motion animations, AnimateIn, size variants preserved in immersive-dialog
10. Window drag mechanics preserved alongside new resize system
</verification>

<success_criteria>
- ImmersiveDialog fully migrated to semantic tokens (title, description, body, icon messages, separator, KeyValue)
- ImmersiveDialog component-specific values preserved (dialog-content bg, close button shadow, overlay, split sections)
- Window resize handles functional on all 4 edges and 4 corners with cursor feedback
- Window resize enforces 400x400 minimum, updates size via UPDATE_SIZE reducer action
- North/west resize correctly adjusts position to keep opposite corner fixed
- EXIT_DURATION_MS increased to 150ms for smoother close animations
- No raw text-24, text-15, text-13, text-12, text-white/*, border-white/4, bg-white/4, rounded-10, rounded-8, opacity-60 remain in immersive-dialog.tsx
- TypeScript compilation succeeds
- No changes to component behavior, props, or exports beyond new resize capability
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-03-window-sheet-system/03-04-SUMMARY.md`
</output>
