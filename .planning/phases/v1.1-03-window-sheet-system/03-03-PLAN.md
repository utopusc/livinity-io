---
phase: v1.1-03-window-sheet-system
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - livos/packages/ui/src/modules/window/window.tsx
  - livos/packages/ui/src/modules/window/window-chrome.tsx
  - livos/packages/ui/src/modules/window/window-content.tsx
autonomous: true

must_haves:
  truths:
    - "Window chrome title pill uses semantic border instead of raw border-2 border-[hsl(var(--color-brand)/0.6)]"
    - "Window chrome title text uses semantic text-body text-text-primary instead of raw text-14 text-white/90"
    - "Window chrome close button uses semantic tokens instead of raw bg-black/70 border-2 border-[hsl(var(--color-brand)/0.6)]"
    - "Window chrome close icon uses semantic h-icon-md w-icon-md text-text-secondary instead of raw h-5 w-5 text-white/70"
    - "Window body uses semantic rounded-radius-xl and border-border-default instead of raw rounded-2xl border-white/10"
    - "Window body backdrop blur reduced from 3xl to xl"
    - "Window content unknown app text uses semantic text-text-secondary instead of raw text-white/50"
    - "Window drag visual feedback added (opacity or shadow change during drag)"
  artifacts:
    - path: "livos/packages/ui/src/modules/window/window-chrome.tsx"
      provides: "Window chrome with semantic tokens and cleaner minimal style"
      contains: "border-border-emphasis"
    - path: "livos/packages/ui/src/modules/window/window.tsx"
      provides: "Window body with semantic tokens and drag feedback"
      contains: "rounded-radius-xl"
    - path: "livos/packages/ui/src/modules/window/window-content.tsx"
      provides: "Window content with semantic text token"
      contains: "text-text-secondary"
  key_links:
    - from: "livos/packages/ui/src/modules/window/window-chrome.tsx"
      to: "livos/packages/ui/src/modules/window/window.tsx"
      via: "WindowChrome rendered inside Window component"
      pattern: "WindowChrome"
    - from: "livos/packages/ui/src/modules/window/window.tsx"
      to: "livos/packages/ui/src/providers/window-manager.tsx"
      via: "useWindowManager for drag/focus state"
      pattern: "useWindowManager"
    - from: "livos/packages/ui/src/modules/window/window.tsx"
      to: "livos/packages/ui/src/modules/window/windows-container.tsx"
      via: "Window rendered inside AnimatePresence"
      pattern: "Window"
---

<objective>
Redesign window chrome and body with semantic tokens and cleaner styling. This covers requirements WS-01 (cleaner title bar), WS-02 (refined window body borders/shadows), and WS-03 (improved drag visual feedback).

Purpose: Windows are the desktop-mode app containers. The current chrome uses thick brand-colored borders that feel heavy. This plan creates a cleaner, more minimal window system with semantic tokens, thinner borders, and visual feedback during drag operations.

Output: Updated window-chrome.tsx with minimal styling, window.tsx with semantic body tokens and drag feedback, window-content.tsx with semantic text token.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md
@.planning/phases/v1.1-03-window-sheet-system/03-RESEARCH.md
@.planning/phases/v1.1-01-design-system/01-01-SUMMARY.md

@livos/packages/ui/tailwind.config.ts
@livos/packages/ui/src/modules/window/window.tsx
@livos/packages/ui/src/modules/window/window-chrome.tsx
@livos/packages/ui/src/modules/window/window-content.tsx
@livos/packages/ui/src/modules/window/windows-container.tsx
@livos/packages/ui/src/providers/window-manager.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Redesign window chrome with cleaner minimal styling</name>
  <files>livos/packages/ui/src/modules/window/window-chrome.tsx</files>
  <action>
Redesign window-chrome.tsx for a cleaner, more minimal appearance. Reduce visual weight: thinner borders, subtler colors, semantic tokens. Preserve the close button and title pill layout structure.

**window-chrome.tsx line 19 — close button className:**
Current:
```
absolute right-full mr-3 group flex items-center justify-center w-10 h-10 rounded-full bg-black/70 backdrop-blur-xl border-2 border-[hsl(var(--color-brand)/0.6)] shadow-xl hover:bg-red-500 hover:border-red-400 transition-all duration-200
```

New:
```
absolute right-full mr-3 group flex items-center justify-center w-9 h-9 rounded-full bg-black/80 backdrop-blur-lg border border-border-emphasis shadow-elevation-md hover:bg-destructive hover:border-destructive/80 transition-all duration-200
```

Changes:
- `w-10 h-10` -> `w-9 h-9` (36px, slightly smaller for minimal feel)
- `bg-black/70` -> `bg-black/80` (slightly more opaque for better readability)
- `backdrop-blur-xl` -> `backdrop-blur-lg` (reduced blur per design direction)
- `border-2 border-[hsl(var(--color-brand)/0.6)]` -> `border border-border-emphasis` (single-pixel border with semantic token instead of thick brand border)
- `shadow-xl` -> `shadow-elevation-md` (semantic elevation shadow)
- `hover:bg-red-500 hover:border-red-400` -> `hover:bg-destructive hover:border-destructive/80` (semantic destructive color)

**window-chrome.tsx line 22 — close icon className:**
Current:
```
h-5 w-5 text-white/70 group-hover:text-white transition-colors
```

New:
```
h-icon-md w-icon-md text-text-secondary group-hover:text-white transition-colors
```

Changes:
- `h-5 w-5` -> `h-icon-md w-icon-md` (20px, same value, semantic token)
- `text-white/70` -> `text-text-secondary` (0.70 -> 0.60, semantic token. Slightly dimmer but consistent with design system.)
- Keep `group-hover:text-white` (full white on destructive hover for contrast)

**window-chrome.tsx line 26 — title pill className:**
Current:
```
flex items-center gap-3 px-5 py-2.5 bg-black/70 backdrop-blur-xl rounded-full border-2 border-[hsl(var(--color-brand)/0.6)] shadow-xl cursor-grab active:cursor-grabbing
```

New:
```
flex items-center gap-3 px-4 py-2 bg-black/80 backdrop-blur-lg rounded-full border border-border-emphasis shadow-elevation-md cursor-grab active:cursor-grabbing
```

Changes:
- `px-5 py-2.5` -> `px-4 py-2` (slightly tighter padding for slimmer pill)
- `bg-black/70` -> `bg-black/80` (matches close button)
- `backdrop-blur-xl` -> `backdrop-blur-lg` (reduced blur)
- `border-2 border-[hsl(var(--color-brand)/0.6)]` -> `border border-border-emphasis` (single-pixel border, semantic token. Removes the heavy brand-colored border in favor of a subtle white/20 emphasis border.)
- `shadow-xl` -> `shadow-elevation-md` (semantic shadow)

**window-chrome.tsx line 28 — title text className:**
Current:
```
text-14 font-medium text-white/90 tracking-tight whitespace-nowrap select-none
```

New:
```
text-body font-medium text-text-primary tracking-tight whitespace-nowrap select-none
```

Changes:
- `text-14` -> `text-body` (body = 14px, same size)
- `text-white/90` -> `text-text-primary` (0.90, same opacity value, semantic token)
- Keep `font-medium` as override (body defaults to 400, title wants 500)

**window-chrome.tsx line 27 — icon className:**
Current:
```
h-5 w-5 rounded-md
```

New:
```
h-icon-md w-icon-md rounded-md
```

Changes:
- `h-5 w-5` -> `h-icon-md w-icon-md` (20px, same value, semantic token)

**Do NOT change:**
- Layout structure (relative flex container, absolute positioning of close button)
- close button onClick stopPropagation pattern
- aria-label on close button
- strokeWidth={2.5} on TbX icon
- cursor-grab / active:cursor-grabbing on title pill
- Component props or exports
  </action>
  <verify>
Grep for `border-border-emphasis` in window-chrome.tsx to confirm semantic border on both close button and title pill.
Grep for `border-2` in window-chrome.tsx to confirm thick border removed.
Grep for `border-\[hsl` in window-chrome.tsx to confirm brand border removed.
Grep for `shadow-elevation-md` in window-chrome.tsx to confirm semantic shadow.
Grep for `text-body` in window-chrome.tsx to confirm semantic title typography.
Grep for `text-text-primary` in window-chrome.tsx to confirm semantic title color.
Grep for `text-text-secondary` in window-chrome.tsx to confirm semantic icon color.
Grep for `h-icon-md` in window-chrome.tsx to confirm semantic icon sizing.
Grep for `hover:bg-destructive` in window-chrome.tsx to confirm semantic destructive hover.
Run `npx tsc --noEmit` in the ui package.
  </verify>
  <done>
Window chrome redesigned with cleaner minimal styling: single-pixel border-border-emphasis instead of thick brand border, bg-black/80 with backdrop-blur-lg, shadow-elevation-md, semantic typography (text-body, text-text-primary), semantic icon sizing (icon-md), semantic destructive hover. Title pill is slimmer (px-4 py-2, w-9 h-9 close button).
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate window body to semantic tokens and add drag visual feedback</name>
  <files>livos/packages/ui/src/modules/window/window.tsx, livos/packages/ui/src/modules/window/window-content.tsx</files>
  <action>
Update window.tsx body styling with semantic tokens and add visual feedback during drag (WS-03). Update window-content.tsx with semantic text token. Preserve all drag mechanics, Framer Motion animations, and component structure.

**window.tsx lines 137-147 — windowClass:**
Current:
```
fixed
flex
flex-col
rounded-2xl
bg-black/90
backdrop-blur-3xl
overflow-hidden
border
border-white/10
```

New:
```
fixed
flex
flex-col
rounded-radius-xl
bg-black/90
backdrop-blur-xl
overflow-hidden
border
border-border-default
```

Changes:
- `rounded-2xl` -> `rounded-radius-xl` (Tailwind 2xl = 16px, radius-xl = 20px. Slightly rounder, matching the semantic system. Windows benefit from the larger radius for a softer appearance.)
- `backdrop-blur-3xl` -> `backdrop-blur-xl` (64px -> 24px. Windows have bg-black/90 so the blur barely shows through the 10% transparency -- reducing it has minimal visual impact but follows the design direction.)
- `border-white/10` -> `border-border-default` (0.10, same value, semantic token)
- Keep `bg-black/90` (intentional near-opaque window background, not a surface)

**window.tsx line 119 — inline boxShadow:**
Current:
```
boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05)'
```

Keep unchanged. This is a CSS inline style combining a deep drop shadow with a subtle ring. The ring at 0.05 could theoretically match border-subtle but it is applied as a boxShadow (not a border class) for the seamless ring effect.

**window.tsx — add drag visual feedback (WS-03):**
The `isDragging` state already exists. Add visual feedback by dynamically adjusting the window body's opacity and shadow during drag.

On the window body motion.div (line 110-132), add conditional styling based on `isDragging`:

Change the motion.div style prop from:
```typescript
style={{
    width: size.width,
    height: size.height,
    left: currentX,
    top: currentY,
    zIndex,
    boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05)',
}}
```

To:
```typescript
style={{
    width: size.width,
    height: size.height,
    left: currentX,
    top: currentY,
    zIndex,
    boxShadow: isDragging
        ? '0 35px 60px -15px rgba(0, 0, 0, 0.7), 0 0 0 1px rgba(255, 255, 255, 0.08)'
        : '0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05)',
    opacity: isDragging ? 0.95 : 1,
    transition: 'box-shadow 0.2s ease, opacity 0.2s ease',
}}
```

This gives a "lifted" visual during drag: deeper shadow (0.5 -> 0.7 opacity, 50px -> 60px spread), slightly brighter ring (0.05 -> 0.08), and subtle opacity reduction (0.95). The CSS transition ensures smooth visual changes without conflicting with Framer Motion's spring-based position animation (Framer handles transform, CSS handles shadow/opacity).

**window.tsx — chrome motion.div (line 92-107):**
Add matching drag feedback on the chrome container. Update the style prop:

Change from:
```typescript
style={{
    left: currentX + size.width / 2,
    top: currentY - 16,
    transform: 'translateX(-50%)',
    zIndex: zIndex + 1,
}}
```

To:
```typescript
style={{
    left: currentX + size.width / 2,
    top: currentY - 16,
    transform: 'translateX(-50%)',
    zIndex: zIndex + 1,
    opacity: isDragging ? 0.9 : 1,
    transition: 'opacity 0.2s ease',
}}
```

Subtle chrome opacity feedback during drag (0.9) to match the window body feedback.

**window-content.tsx line 62 — unknown app text:**
Current:
```
text-white/50
```

New:
```
text-text-secondary
```

Changes:
- `text-white/50` -> `text-text-secondary` (0.50 -> 0.60, semantic token)

**window-content.tsx — contentWrapperClass and contentInnerClass:**
Keep unchanged. These are layout classes (`h-full overflow-auto`, `flex flex-col gap-5 p-4 md:p-6`) with no raw color tokens.

**Do NOT change:**
- Drag mechanics (mousedown/mousemove/mouseup event handling)
- Framer Motion animation values (initial, animate, exit, transition spring physics)
- Window position clamping logic
- WindowContent lazy loading system
- WindowAppContent switch/case routing
- Component props or exports
- windows-container.tsx (no changes needed)
  </action>
  <verify>
Grep for `rounded-radius-xl` in window.tsx to confirm semantic radius.
Grep for `backdrop-blur-xl` in window.tsx to confirm reduced blur (should find exactly one, not backdrop-blur-3xl).
Grep for `border-border-default` in window.tsx to confirm semantic border.
Grep for `rounded-2xl` in window.tsx to confirm old radius removed.
Grep for `backdrop-blur-3xl` in window.tsx to confirm old blur removed.
Grep for `border-white/10` in window.tsx to confirm raw border removed.
Grep for `isDragging` in window.tsx to confirm drag feedback references exist in style props.
Grep for `text-text-secondary` in window-content.tsx to confirm semantic text token.
Grep for `text-white/50` in window-content.tsx to confirm raw color removed.
Verify the string `0.7` appears in window.tsx boxShadow (the drag shadow).
Run `npx tsc --noEmit` in the ui package.
  </verify>
  <done>
Window body uses semantic tokens: rounded-radius-xl, backdrop-blur-xl, border-border-default. Visual drag feedback added: deeper shadow, brighter ring, and subtle opacity reduction during drag with CSS transitions (does not conflict with Framer Motion spring animations). Window content unknown app text uses text-text-secondary. All drag mechanics, Framer Motion animations, and component structure preserved.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in ui package
2. window-chrome.tsx: `border-border-emphasis`, `shadow-elevation-md`, `text-body`, `text-text-primary`, `text-text-secondary`, `h-icon-md`, `hover:bg-destructive` present
3. window-chrome.tsx: `border-2`, `border-[hsl(`, `shadow-xl`, `text-14`, `text-white/90`, `text-white/70`, `h-5 w-5` absent (on close icon and title icon)
4. window.tsx: `rounded-radius-xl`, `backdrop-blur-xl`, `border-border-default` present
5. window.tsx: `rounded-2xl`, `backdrop-blur-3xl`, `border-white/10` absent
6. window.tsx: Drag feedback visible in style props (isDragging ternary for boxShadow and opacity)
7. window-content.tsx: `text-text-secondary` present; `text-white/50` absent
8. Framer Motion spring animations unchanged (stiffness: 500, damping: 35)
9. All drag mechanics preserved (mousedown/mousemove/mouseup)
10. No changes to component behavior, props, or exports
</verification>

<success_criteria>
- Window chrome redesigned with cleaner minimal style (WS-01): thinner borders, semantic tokens, slimmer profile
- Window body refined with semantic tokens (WS-02): rounded-radius-xl, border-border-default, reduced blur
- Drag visual feedback added (WS-03): deeper shadow + opacity change during drag, smooth CSS transitions
- Window chrome close button uses semantic destructive hover instead of raw red-500
- Title text and icon use semantic typography and sizing tokens
- All raw border-2, border-[hsl(...)], shadow-xl, text-white/*, bg-black/70 eliminated from chrome
- All raw rounded-2xl, backdrop-blur-3xl, border-white/10 eliminated from window body
- TypeScript compilation succeeds
- No changes to drag mechanics, Framer Motion animations, or component exports
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-03-window-sheet-system/03-03-SUMMARY.md`
</output>
