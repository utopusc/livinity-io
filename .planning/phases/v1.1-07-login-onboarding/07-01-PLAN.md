---
phase: 07-login-onboarding
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - livos/packages/ui/src/layouts/bare/shared.tsx
  - livos/packages/ui/src/layouts/bare/bare-page.tsx
  - livos/packages/ui/src/components/darken-layer.tsx
  - livos/packages/ui/src/components/ui/step-indicator.tsx
autonomous: true

must_haves:
  truths:
    - "All auth pages use semantic design tokens for typography, colors, and spacing"
    - "Primary auth button uses brand color instead of white"
    - "Layout component supports an optional step indicator slot"
    - "Step indicator component exists and renders dot/pill progress"
  artifacts:
    - path: "livos/packages/ui/src/layouts/bare/shared.tsx"
      provides: "Semantic token migration for Title, SubTitle, buttonClass, secondaryButtonClass, footerLinkClass, formGroupClass, Layout with stepIndicator prop"
      contains: "text-display"
    - path: "livos/packages/ui/src/components/ui/step-indicator.tsx"
      provides: "Reusable step indicator component"
      exports: ["StepIndicator"]
    - path: "livos/packages/ui/src/layouts/bare/bare-page.tsx"
      provides: "Bare page wrapper with semantic token"
    - path: "livos/packages/ui/src/components/darken-layer.tsx"
      provides: "Darken layer overlay"
  key_links:
    - from: "livos/packages/ui/src/layouts/bare/shared.tsx"
      to: "livos/packages/ui/src/components/ui/step-indicator.tsx"
      via: "Layout renders optional stepIndicator prop"
      pattern: "stepIndicator"
---

<objective>
Migrate the shared auth layout foundation (shared.tsx, bare-page.tsx, darken-layer.tsx) from raw Tailwind values to semantic design tokens established in Phase 1. Create a reusable StepIndicator component. Enhance the Layout component to accept an optional step indicator slot.

Purpose: This is the foundation for all auth page redesign. Every login and onboarding page imports from shared.tsx, so migrating it first ensures all downstream pages inherit the new brand identity automatically.
Output: Updated shared.tsx with semantic tokens and brand-themed buttons, new StepIndicator component, minor token updates to bare-page.tsx and darken-layer.tsx.
</objective>

<execution_context>
@C:\Users\hello\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\hello\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP-v1.1.md
@.planning/STATE.md

@livos/packages/ui/src/layouts/bare/shared.tsx
@livos/packages/ui/src/layouts/bare/bare-page.tsx
@livos/packages/ui/src/components/darken-layer.tsx
@livos/packages/ui/src/assets/livinity-logo.tsx
@.planning/phases/v1.1-07-login-onboarding/07-RESEARCH.md
@.planning/phases/v1.1-01-design-system/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate shared.tsx to semantic tokens and brand-themed buttons</name>
  <files>livos/packages/ui/src/layouts/bare/shared.tsx</files>
  <action>
Migrate all raw Tailwind values in shared.tsx to semantic design tokens. Apply these specific changes:

**Title component:**
- `text-3xl` (30px) -> `text-display-sm` (32px) for mobile
- `text-56` (56px) -> keep `md:text-56` (custom size is intentional for auth hero text, no semantic match at 56px)
- Keep `font-bold`, `leading-tight`, `-tracking-2`

**SubTitle component:**
- `text-sm` -> `text-body` (14px semantic match)
- `opacity-50` -> replace entirely with `text-text-secondary` (provides 0.60 opacity via rgba, better readability than 0.50)
- `md:text-base` -> `md:text-body-lg` (16px semantic match)

**footerLinkClass:**
- `text-13` -> `text-body-sm` (13px semantic match)
- `text-white/60` -> `text-text-secondary`
- `hover:text-white/80` -> `hover:text-text-primary`
- Keep `transition-colors`, `font-normal`, `-tracking-3`
- `focus-visible:ring-3` -> `focus-visible:ring-2 focus-visible:ring-brand/20` (consistent with Phase 1 brand focus pattern)

**buttonClass (primary):**
- `bg-white` -> `bg-brand` (prior decision: "bg-brand for primary actions")
- `text-black` -> `text-white` (brand bg needs white text)
- `text-14` -> `text-body` (14px semantic match)
- `h-[42px]` -> `h-12` (48px, standardize to Tailwind scale)
- `ring-white/40` -> `ring-brand/20` (brand focus pattern from Phase 1)
- `hover:bg-white/80` -> `hover:bg-brand-lighter`
- `active:bg-white/90` -> `active:bg-brand` (press returns to base)
- Keep `rounded-full`, `min-w-[112px]`, `justify-center`, `disabled:pointer-events-none`, `disabled:opacity-50`, `transition-all`, `duration-300`, `px-4`, `font-medium`, `-tracking-1`
- Add `focus-visible:border-brand` for the brand focus pattern

**secondaryButtonClasss (NOTE: has typo with triple 's' — preserve the typo to avoid breaking imports):**
- `bg-neutral-600/40` -> `bg-surface-2`
- `hover:bg-neutral-600/60` -> `hover:bg-surface-3`
- `active:bg-neutral-600/60` -> `active:bg-surface-3`
- `text-14` -> `text-body`
- `h-[42px]` -> `h-12`
- `ring-white/40` -> `ring-brand/20`
- Keep `backdrop-blur-sm`, `text-white`, `rounded-full`, other shared props

**formGroupClass:**
- Keep as-is (`flex w-full max-w-sm flex-col gap-2.5`) — already clean

**Layout component:**
- Add optional `stepIndicator?: React.ReactNode` prop to Layout props interface
- Render `{stepIndicator}` between `<LivinityLogoLarge />` and the title/subtitle block
- Change gap from `gap-5` to `gap-6` in the main content column for slightly more breathing room
- Keep everything else (flex-1 spacers, footer, transitionTitle, subTitleMaxWidth)

**LivinityLogoLarge:**
- Keep `md:w-[120px]` — logo sizing is intentional and has no semantic match

Do NOT change: view transition logic, Layout's structural flex layout, footerClass (`flex items-center justify-center gap-4` is clean).
  </action>
  <verify>
Run `npx tsc --noEmit` from `livos/packages/ui/` to confirm no type errors.
Grep shared.tsx for remaining raw values: should find no `text-white/`, `bg-white`, `bg-neutral`, `opacity-50`, `text-black`, `h-[42px]`.
  </verify>
  <done>
shared.tsx uses semantic tokens throughout. Title uses text-display-sm, SubTitle uses text-text-secondary, buttons use bg-brand/bg-surface-2, footer links use text-text-secondary/text-text-primary. Layout accepts optional stepIndicator prop.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create StepIndicator component</name>
  <files>livos/packages/ui/src/components/ui/step-indicator.tsx</files>
  <action>
Create a new `StepIndicator` component at `src/components/ui/step-indicator.tsx`.

Implementation:
```typescript
import {cn} from '@/shadcn-lib/utils'

interface StepIndicatorProps {
  steps: number
  currentStep: number // 0-indexed
  className?: string
}

export function StepIndicator({steps, currentStep, className}: StepIndicatorProps) {
  return (
    <div className={cn('flex items-center gap-2', className)}>
      {Array.from({length: steps}, (_, i) => (
        <div
          key={i}
          className={cn(
            'h-1.5 rounded-full transition-all duration-300',
            i === currentStep
              ? 'w-6 bg-brand'
              : i < currentStep
                ? 'w-1.5 bg-brand/50'
                : 'w-1.5 bg-surface-3',
          )}
        />
      ))}
    </div>
  )
}
```

Key design decisions:
- Active step is elongated pill (w-6) with `bg-brand` for clear identification
- Completed steps are small dots with `bg-brand/50` (dimmed brand)
- Future steps are small dots with `bg-surface-3` (neutral)
- `transition-all duration-300` for smooth step transitions
- `h-1.5` (6px) height for subtle but visible indicator
- `gap-2` (8px) between dots
- Accepts `className` for positioning flexibility
- 0-indexed `currentStep` to match array/enum conventions used in restore.tsx Step enum
  </action>
  <verify>
Run `npx tsc --noEmit` from `livos/packages/ui/` to confirm no type errors.
Verify file exists and exports StepIndicator.
  </verify>
  <done>
StepIndicator component exists at src/components/ui/step-indicator.tsx, exports a single named export, uses semantic tokens (bg-brand, bg-surface-3), accepts steps/currentStep/className props.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update bare-page.tsx and darken-layer.tsx tokens</name>
  <files>
    livos/packages/ui/src/layouts/bare/bare-page.tsx
    livos/packages/ui/src/components/darken-layer.tsx
  </files>
  <action>
Minor token updates to these two small files:

**bare-page.tsx:**
- `min-h-[100dvh]` -> `min-h-dvh` (Tailwind 3.4 has `min-h-dvh` shorthand — verify it exists in config, if not, keep `min-h-[100dvh]`)
- Keep `bg-black/50` on DarkenLayer (it's used via the component, not inline)
- Keep `p-5` (standard spacing, no semantic equivalent needed)
- No other changes needed — file is already clean (12 lines)

**darken-layer.tsx:**
- File is already clean: `bg-black/50 contrast-more:bg-black` with `cn()` for className override
- This is an intentional overlay color, not a generic surface. Keep as-is.
- No changes needed.

If `min-h-dvh` is not available in the Tailwind config, skip the bare-page change and leave the file untouched. The file is already clean enough.
  </action>
  <verify>
Run `npx tsc --noEmit` from `livos/packages/ui/` to confirm no type errors.
Both files should be minimal and clean.
  </verify>
  <done>
bare-page.tsx and darken-layer.tsx reviewed and updated where applicable. Both files use appropriate values (intentional overlay colors preserved, Tailwind shorthand applied if available).
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes from livos/packages/ui/
2. `pnpm run build` succeeds from livos/packages/ui/ (or `npx vite build`)
3. No raw `text-white/`, `bg-white`, `bg-neutral-600`, `opacity-50`, `text-black`, `h-[42px]` remain in shared.tsx
4. StepIndicator component exists and exports correctly
5. Layout component accepts optional stepIndicator prop
</verification>

<success_criteria>
- shared.tsx uses semantic tokens for all typography, colors, and spacing
- buttonClass uses bg-brand instead of bg-white
- secondaryButtonClasss uses bg-surface-2 instead of bg-neutral-600/40
- Layout has stepIndicator slot between logo and title
- StepIndicator component renders correctly with brand tokens
- All auth pages that import from shared.tsx still compile and render
</success_criteria>

<output>
After completion, create `.planning/phases/v1.1-07-login-onboarding/07-01-SUMMARY.md`
</output>
